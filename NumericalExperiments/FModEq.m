function FOut = FModEq(z)

global alpha c dt dx v

FOut = [((-1)+c.^2).^(-1).*(alpha.*c.*z(2)+z(3)),((-1)+c.^2).^(-1).*((-1).*alpha.*c.*z(1)+z(4)),alpha.*c.*((-1)+c.^2).^(-1).*(alpha.*c.*z(1)+(-1).*z(4))+(1/12).*((-1)+c.^2).^(-4).*(z(1).*(alpha.^2.*(12+(-24).*c.^2+24.*c.^6+(-12).*c.^8+(-1).*alpha.^2.*dt.^2+(-6).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+6.*alpha.^2.*c.^2.*dx.^2+alpha.^2.*c.^4.*dx.^2+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-2).*((-1)+c.^2).*(6+(-18).*c.^2+18.*c.^4+(-6).*c.^6+(-3).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+3.*alpha.^2.*c.^2.*dx.^2+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(-1).*((-1)+c.^2).^2.*(c.^4.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2)))).^2+(-8).*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(2).*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2).*z(3)+(-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*(6.*v(2)+2.*v(3).*(5.*z(1).^2+3.*z(2).^2)+v(4).*(7.*z(1).^4+10.*z(1).^2.*z(2).^2+3.*z(2).^4)).*z(3).^2)+4.*(alpha.*c.*((-6)+(-18).*c.^4+6.*c.^6+alpha.^2.*dt.^2+(-1).*alpha.^2.*dx.^2+c.^2.*(18+alpha.^2.*(dt.^2+(-1).*dx.^2))+(-2).*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-1).*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(-1/2).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).*(2.*v(2)+2.*v(3).*(3.*z(1).^2+z(2).^2)+v(4).*(5.*z(1).^4+6.*z(1).^2.*z(2).^2+z(2).^4)).*z(3)).*z(4)+(-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).*(2.*v(2)+2.*v(3).*(z(1).^2+3.*z(2).^2)+v(4).*(z(1).^4+6.*z(1).^2.*z(2).^2+5.*z(2).^4)).*z(4).^2),(1/12).*((-1)+c.^2).^(-4).*((-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).*(2.*v(2)+2.*v(3).*(3.*z(1).^2+z(2).^2)+v(4).*(5.*z(1).^4+6.*z(1).^2.*z(2).^2+z(2).^4)).*z(3).^2+(-4).*z(3).*(alpha.*c.*((-3)+(-9).*c.^4+3.*c.^6+alpha.^2.*dt.^2+(-1).*alpha.^2.*dx.^2+c.^2.*(9+alpha.^2.*(dt.^2+(-1).*dx.^2))+(-2).*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-1).*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(1/2).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).*(2.*v(2)+2.*v(3).*(z(1).^2+3.*z(2).^2)+v(4).*(z(1).^4+6.*z(1).^2.*z(2).^2+5.*z(2).^4)).*z(4))+z(2).*(alpha.^2.*(12+(-36).*c.^2+36.*c.^4+(-12).*c.^6+(-1).*alpha.^2.*dt.^2+(-6).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+6.*alpha.^2.*c.^2.*dx.^2+alpha.^2.*c.^4.*dx.^2+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-2).*((-1)+c.^2).*(6+(-18).*c.^2+18.*c.^4+(-6).*c.^6+(-3).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+3.*alpha.^2.*c.^2.*dx.^2+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(-1).*((-1)+c.^2).^2.*(c.^4.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2)))).^2+8.*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(1).*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2).*z(4)+(-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*(6.*v(2)+2.*v(3).*(3.*z(1).^2+5.*z(2).^2)+v(4).*(3.*z(1).^4+10.*z(1).^2.*z(2).^2+7.*z(2).^4)).*z(4).^2))]';

end