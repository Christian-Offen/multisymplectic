(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75282,       1971]
NotebookOptionsPosition[     72366,       1870]
NotebookOutlinePosition[     72714,       1885]
CellTagsIndexPosition[     72671,       1882]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792263178913028*^9, 3.7922631848983994`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.792263187369773*^9, 3.7922631906034107`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7922631914488564`*^9, 3.792284306659311*^9, 3.7922927325773687`*^9, 
   3.792355273375464*^9, 3.7923632163769226`*^9, 3.7923661804987164`*^9, 
   3.7923671167829323`*^9, 3.792367353647193*^9, 3.792368456988278*^9, 
   3.792371085703386*^9, 3.792379754439374*^9, 3.7923798185035667`*^9, {
   3.7923803818443127`*^9, 3.792380405875782*^9}, 3.792429980659584*^9, {
   3.792430380141473*^9, 3.792430403973529*^9}, 3.7924313384548645`*^9, 
   3.792432094402141*^9, 3.7924327536733723`*^9, 3.7924333678456345`*^9, 
   3.792433446867623*^9, 3.792880307230112*^9, 3.79288044823468*^9, 
   3.792883244043524*^9, 3.7928835449565926`*^9, 3.792892659992478*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"L0", "[", 
   RowBox[{"q_", ",", "qdot_"}], "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"1", "/", "2"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Alpha]", "^", "2"}], " ", 
      RowBox[{"Dot", "[", 
       RowBox[{"q", ",", "q"}], "]"}]}], " ", "-", " ", 
     RowBox[{"2", " ", "\[Alpha]", " ", "c", " ", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"J", ".", "q"}], ")"}], ",", "qdot"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "^", "2"}], "-", "1"}], ")"}], " ", 
      RowBox[{"Dot", "[", 
       RowBox[{"qdot", ",", "qdot"}], "]"}]}], "+", 
     RowBox[{"V", "[", 
      RowBox[{"Dot", "[", 
       RowBox[{"q", ",", "q"}], "]"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7928803713263607`*^9, 3.7928803723573666`*^9}, {
  3.792880461313673*^9, 3.7928804633618474`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Alpha]", "2"], " ", 
     RowBox[{"q", ".", "q"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c", "2"]}], ")"}], " ", 
     RowBox[{"qdot", ".", "qdot"}]}], "-", 
    RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ".", "q", ".", 
      "qdot"}]}], "+", 
    RowBox[{"V", "[", 
     RowBox[{"q", ".", "q"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7921871678827295`*^9, 3.792188178124771*^9, {3.7921882525008197`*^9, 
   3.7921882671296883`*^9}, 3.7921888627604437`*^9, 3.792189166161556*^9, 
   3.792203046954616*^9, 3.792284307682309*^9, 3.7922927326086116`*^9, 
   3.79235527345357*^9, 3.7923632164394073`*^9, 3.7923661805299597`*^9, 
   3.792367116861038*^9, 3.79236735369404*^9, 3.792368457050709*^9, 
   3.7923710857346535`*^9, 3.7923797544862375`*^9, 3.792379818550432*^9, {
   3.7923803818755236`*^9, 3.792380405907024*^9}, 3.792429980675211*^9, {
   3.792430380172714*^9, 3.7924304039891224`*^9}, 3.7924313384704857`*^9, 
   3.7924320944333515`*^9, 3.7924327537046423`*^9, 3.7924333678768835`*^9, 
   3.792433446898861*^9, 3.7928803074956465`*^9, {3.7928804494687357`*^9, 
   3.7928804642676506`*^9}, 3.792883244074751*^9, 3.792883544987867*^9, 
   3.792892660008103*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pqqdot", " ", "=", "  ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"L0", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], ",", 
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["q", "1"], "\[Prime]",
         MultilineFunction->None], ",", 
        SuperscriptBox[
         SubscriptBox["q", "2"], "\[Prime]",
         MultilineFunction->None]}], "}"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792284516874494*^9, 3.7922845203076344`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", "\[Alpha]", " ", 
     SubscriptBox["q", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c", "2"]}], ")"}], " ", 
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None]}]}], ",", 
   RowBox[{
    RowBox[{"c", " ", "\[Alpha]", " ", 
     SubscriptBox["q", "1"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c", "2"]}], ")"}], " ", 
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7921871894550257`*^9, 3.7921881781866484`*^9, {3.792188252528745*^9, 
   3.7921882671536245`*^9}, 3.7921888627813883`*^9, 3.7921891661884756`*^9, 
   3.7922030469924984`*^9, 3.792284308877407*^9, 3.7922845206591625`*^9, 
   3.792292732639863*^9, 3.792355273516055*^9, 3.792363216501892*^9, 
   3.7923661806081195`*^9, 3.792367116923521*^9, 3.7923673537565246`*^9, 
   3.7923684571444435`*^9, 3.7923710857971134`*^9, 3.792379754517482*^9, 
   3.792379818597293*^9, {3.7923803819223957`*^9, 3.7923804059808955`*^9}, 
   3.7924299807533116`*^9, {3.7924303801883364`*^9, 3.792430404004744*^9}, 
   3.792431338501728*^9, 3.792432094464594*^9, 3.792432753720236*^9, 
   3.7924333678924704`*^9, 3.792433446914486*^9, 3.792880307542511*^9, 
   3.7928804768938246`*^9, 3.7928832440903625`*^9, 3.7928835450191092`*^9, 
   3.7928926600705943`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qdotqp", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"pqqdot", "==", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["p", "1"], ",", 
       SubscriptBox["p", "2"]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["p", "1"], "+", 
       RowBox[{"c", " ", "\[Alpha]", " ", 
        SubscriptBox["q", "2"]}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c", "2"]}]]}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None], "\[Rule]", 
     FractionBox[
      RowBox[{
       SubscriptBox["p", "2"], "-", 
       RowBox[{"c", " ", "\[Alpha]", " ", 
        SubscriptBox["q", "1"]}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c", "2"]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.792187199622901*^9, 3.792188178211544*^9, {3.792188252553678*^9, 
   3.7921882671765633`*^9}, 3.792188862800346*^9, 3.7921891662134256`*^9, 
   3.792203047025439*^9, 3.7922843099094543`*^9, 3.792292732671097*^9, 
   3.7923552735785418`*^9, 3.7923632165331364`*^9, 3.792366180670558*^9, 
   3.7923671169860325`*^9, 3.792367353819009*^9, 3.7923684572069163`*^9, 
   3.7923710858439775`*^9, 3.7923797545643444`*^9, 3.7923798186441855`*^9, {
   3.7923803819536304`*^9, 3.792380406005106*^9}, 3.792429980768933*^9, {
   3.792430380203957*^9, 3.7924304040203657`*^9}, 3.7924313385329704`*^9, 
   3.792432094511207*^9, 3.792432753751478*^9, 3.792433367923753*^9, 
   3.792433446945696*^9, 3.7928803076518593`*^9, 3.7928804804567776`*^9, 
   3.7928832441216145`*^9, 3.7928835450503197`*^9, 3.792892660086179*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Hqp", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], ",", 
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["p", "1"], ",", 
         SubscriptBox["p", "2"]}], "}"}]}], "]"}], "-", 
     RowBox[{"L0", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["q", "1"], ",", 
         SubscriptBox["q", "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], ",", 
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None]}], "}"}]}], "]"}]}], "/.", 
    RowBox[{"qdotqp", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SubsuperscriptBox["p", "1", "2"], "+", 
   SubsuperscriptBox["p", "2", "2"], "-", 
   RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
    SubscriptBox["p", "2"], " ", 
    SubscriptBox["q", "1"]}], "+", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], " ", 
    SubsuperscriptBox["q", "1", "2"]}], "+", 
   RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
    SubscriptBox["p", "1"], " ", 
    SubscriptBox["q", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], " ", 
    SubsuperscriptBox["q", "2", "2"]}], "+", 
   RowBox[{"V", "[", 
    RowBox[{
     SubsuperscriptBox["q", "1", "2"], "+", 
     SubsuperscriptBox["q", "2", "2"]}], "]"}], "-", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", 
    RowBox[{"V", "[", 
     RowBox[{
      SubsuperscriptBox["q", "1", "2"], "+", 
      SubsuperscriptBox["q", "2", "2"]}], "]"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.7921872071038036`*^9, 3.7921881782374706`*^9, {3.7921882525806065`*^9, 
   3.7921882672044888`*^9}, 3.792188862826268*^9, 3.7921891662343807`*^9, 
   3.7922030470583515`*^9, 3.7922843115512247`*^9, 3.79229273270234*^9, 
   3.792355273656649*^9, 3.7923632165643773`*^9, 3.792366180717449*^9, 
   3.7923671170328665`*^9, 3.792367353881494*^9, 3.792368457300645*^9, 
   3.792371085859598*^9, 3.792379754611209*^9, 3.7923798186754007`*^9, {
   3.7923803820004945`*^9, 3.7923804060363503`*^9}, 3.7924299808158236`*^9, {
   3.7924303802196107`*^9, 3.792430404051608*^9}, 3.7924313385642138`*^9, 
   3.7924320945464125`*^9, 3.7924327537827215`*^9, 3.7924333679546947`*^9, 
   3.7924334469613175`*^9, 3.792880307729967*^9, 3.7928804822688527`*^9, 
   3.7928832441528625`*^9, 3.7928835450815954`*^9, 3.7928926601174216`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsdym", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["q", "1"], ",", 
     SubscriptBox["q", "2"], ",", 
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], ",", 
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7921899112355723`*^9, 3.792189934324796*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsqp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["q", "1"], ",", 
     SubscriptBox["q", "2"], ",", 
     SubscriptBox["p", "1"], ",", 
     SubscriptBox["p", "2"]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7921904706954436`*^9, 3.7921904852794557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsall", " ", "=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"varsdym", ",", "varsqp", ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["p", "1"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["p", "2"], "\[Prime]",
        MultilineFunction->None]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7921904881607113`*^9, 3.792190510009288*^9}, {
  3.792191750056456*^9, 3.792191765319621*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tadd", " ", "=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "\[Rule]", 
      RowBox[{"#", "[", "t", "]"}]}], "&"}], ",", "varsall"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792189937656871*^9, 3.7921899580901604`*^9}, {
  3.7921904382363358`*^9, 3.7921904522737665`*^9}, {3.7921905197860923`*^9, 
  3.792190520103243*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["p", "1"], "\[Rule]", 
    RowBox[{
     SubscriptBox["p", "1"], "[", "t", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["p", "2"], "\[Rule]", 
    RowBox[{
     SubscriptBox["p", "2"], "[", "t", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["q", "1"], "\[Rule]", 
    RowBox[{
     SubscriptBox["q", "1"], "[", "t", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["q", "2"], "\[Rule]", 
    RowBox[{
     SubscriptBox["q", "2"], "[", "t", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["p", "1"], "\[Prime]",
     MultilineFunction->None], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["p", "2"], "\[Prime]",
     MultilineFunction->None], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "1"], "\[Prime]",
     MultilineFunction->None], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "2"], "\[Prime]",
     MultilineFunction->None], "\[Rule]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.792189958477125*^9, 3.7921905206069064`*^9, 3.7921917695622587`*^9, 
   3.792203047180996*^9, 3.792284316429272*^9, 3.7922927328116884`*^9, 
   3.7923552738128633`*^9, 3.7923632166893497`*^9, 3.7923661807955294`*^9, 
   3.792367117235963*^9, 3.79236735410019*^9, 3.7923684575349736`*^9, 
   3.7923710859845695`*^9, 3.7923797547361903`*^9, 3.79237981880039*^9, {
   3.7923803821134233`*^9, 3.7923804061613207`*^9}, 3.7924299808627424`*^9, {
   3.7924303802664433`*^9, 3.7924304040984945`*^9}, 3.792431338673571*^9, 
   3.792432094640144*^9, 3.7924327538953905`*^9, 3.792433368036663*^9, 
   3.792433447055046*^9, 3.792880307808107*^9, 3.79288049499121*^9, 
   3.792883244256474*^9, 3.7928835451787605`*^9, 3.792892660195527*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"tremove", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["p", "1"]}], ",", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "2"], "[", "t", "]"}], "\[Rule]", 
      SubscriptBox["p", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "1"], "[", "t", "]"}], "->", 
      SubscriptBox["q", "1"]}], ",", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "->", 
      SubscriptBox["q", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["p", "1"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "->", 
      SuperscriptBox[
       SubscriptBox["p", "1"], "\[Prime]",
       MultilineFunction->None]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["p", "2"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      SuperscriptBox[
       SubscriptBox["p", "2"], "\[Prime]",
       MultilineFunction->None]}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "->", 
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "->", 
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7921898522584076`*^9, 3.7921898619045887`*^9}, {
  3.79219056066471*^9, 3.792190574890648*^9}, {3.7921917850268583`*^9, 
  3.792191824185095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"phi2RedSave", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]", " ", "\[Rule]", "t"}], ",", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], "\[Rule]", 
           SubscriptBox["q", "1"]}], ",", 
          RowBox[{
           SubscriptBox["\[Phi]", "2"], "\[Rule]", 
           SubscriptBox["q", "2"]}], ",", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[Phi]", "1"], "\[Prime]",
            MultilineFunction->None], "\[Rule]", " ", 
           SuperscriptBox[
            SubscriptBox["q", "1"], "\[Prime]",
            MultilineFunction->None]}], ",", 
          RowBox[{
           SuperscriptBox[
            SubscriptBox["\[Phi]", "2"], "\[Prime]",
            MultilineFunction->None], "\[Rule]", " ", 
           SuperscriptBox[
            SubscriptBox["q", "2"], "\[Prime]",
            MultilineFunction->None]}]}], "}"}]}], "/.", "tremove"}], "]"}], "/.", 
     RowBox[{"qdotqp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7921893255439806`*^9, 3.79218942291441*^9}, {
   3.792189560437329*^9, 3.792189569426303*^9}, {3.7921896025905533`*^9, 
   3.792189753107749*^9}, 3.792189846179637*^9, {3.79219021148308*^9, 
   3.792190212626055*^9}, {3.792190851931403*^9, 3.792190872631979*^9}, {
   3.792191374548087*^9, 3.7921913751016135`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqqdot", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "1"], "\[Prime]",
      MultilineFunction->None], " ", "\[Equal]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], "/.", 
       RowBox[{"qdotqp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["q", "2"], "\[Prime]",
      MultilineFunction->None], " ", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], "/.", 
       RowBox[{"qdotqp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.792191000270501*^9, 3.792191000839941*^9}, {
  3.7921910638204565`*^9, 3.7921911238648167`*^9}, {3.7921911853263693`*^9, 
  3.7921912261232185`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "1"], "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "+", 
      RowBox[{"c", " ", "\[Alpha]", " ", 
       SubscriptBox["q", "2"]}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["c", "2"]}]]}], ",", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["q", "2"], "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "-", 
      RowBox[{"c", " ", "\[Alpha]", " ", 
       SubscriptBox["q", "1"]}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["c", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7921909936562347`*^9, 3.7921910012928076`*^9}, {
   3.792191067738945*^9, 3.7921911245440655`*^9}, 3.792191226504242*^9, 
   3.792191377171132*^9, 3.7921918278723087`*^9, 3.792192318719119*^9, 
   3.7922030476986847`*^9, 3.7922844781890993`*^9, 3.7922927338653603`*^9, 
   3.792355274907778*^9, 3.792363217767221*^9, 3.792366181827982*^9, 
   3.792367117454631*^9, 3.7923673542251596`*^9, 3.7923684583004107`*^9, 
   3.7923710870311985`*^9, 3.7923797559233985`*^9, 3.7923798190034485`*^9, {
   3.7923803822228146`*^9, 3.7923804062862988`*^9}, 3.7924299808939033`*^9, {
   3.7924303802976847`*^9, 3.7924304051138554`*^9}, 3.792431339767053*^9, 
   3.792432094702626*^9, 3.7924327539737625`*^9, 3.792433368099149*^9, 
   3.792433447148773*^9, 3.792880309574837*^9, 3.7928805007423086`*^9, 
   3.7928832452850266`*^9, 3.79288354570988*^9, 3.792892661196942*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qddotqp", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["q", "1"], "\[Prime]",
          MultilineFunction->None], ",", 
         SuperscriptBox[
          SubscriptBox["q", "2"], "\[Prime]",
          MultilineFunction->None]}], "}"}], "/.", 
       RowBox[{"qdotqp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", "tadd"}], ",", "t"}], "]"}], "/.",
    "tremove"}]}]], "Input",
 CellChangeTimes->{{3.7921902530289326`*^9, 3.792190337737261*^9}, {
  3.79219064609416*^9, 3.7921906491529436`*^9}, {3.79219100892633*^9, 
  3.7921910095586376`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "1"], "\[Prime]",
      MultilineFunction->None], "+", 
     RowBox[{"c", " ", "\[Alpha]", " ", 
      SuperscriptBox[
       SubscriptBox["q", "2"], "\[Prime]",
       MultilineFunction->None]}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      SubscriptBox["p", "2"], "\[Prime]",
      MultilineFunction->None], "-", 
     RowBox[{"c", " ", "\[Alpha]", " ", 
      SuperscriptBox[
       SubscriptBox["q", "1"], "\[Prime]",
       MultilineFunction->None]}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.7921903192108316`*^9, 3.79219033963822*^9}, 
   3.7921905894905877`*^9, 3.7921906496596317`*^9, 3.7921909102663155`*^9, 
   3.792191010055296*^9, 3.792191244290574*^9, 3.792191378136467*^9, 
   3.7921918287918453`*^9, 3.792192319825156*^9, 3.792203047731537*^9, 
   3.792284479466357*^9, 3.792292733896603*^9, 3.7923552749858766`*^9, 
   3.792363217798464*^9, 3.7923661818592253`*^9, 3.7923671175014925`*^9, 
   3.792367354272023*^9, 3.792368458378519*^9, 3.792371087062441*^9, 
   3.792379755970289*^9, 3.7923798190346904`*^9, {3.792380382254016*^9, 
   3.792380406317534*^9}, 3.7924299809095235`*^9, {3.792430380313309*^9, 
   3.7924304051450987`*^9}, 3.792431339798295*^9, 3.7924320947338686`*^9, 
   3.792432754005005*^9, 3.792433368130391*^9, 3.7924334471956377`*^9, 
   3.792880309715432*^9, 3.792880502242036*^9, 3.7928832453197513`*^9, 
   3.792883545751893*^9, 3.792892661212595*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsF", " ", "=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{"eqqdot", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"qddotqp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
        RowBox[{"phi2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"qddotqp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "\[Equal]", " ", 
        RowBox[{"phi2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.792191333835031*^9, {3.7921914045298843`*^9, 3.792191405687792*^9}, {
   3.7921917026731896`*^9, 3.7921917177089906`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soleqsF", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"eqsF", ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["p", "1"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["p", "2"], "\[Prime]",
        MultilineFunction->None]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792192336371842*^9, 3.7921923943347883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["q", "1"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["q", "2"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["p", "1"], "\[Prime]",
        MultilineFunction->None], ",", 
       SuperscriptBox[
        SubscriptBox["p", "2"], "\[Prime]",
        MultilineFunction->None]}], "}"}], "/.", 
     RowBox[{"soleqsF", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792192255189025*^9, 3.7921922894303956`*^9}, {
  3.7921924086654425`*^9, 3.792192441503598*^9}, {3.792286999284481*^9, 
  3.7922870180767827`*^9}}],

Cell[BoxData[
 RowBox[{"<<", "ToMatlab`", " "}]], "Input",
 CellChangeTimes->{{3.792184628644541*^9, 3.7921846469635134`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"h", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"dx", "\[Rule]", "0.001"}], ",", " ", 
     RowBox[{"dt", "\[Rule]", " ", "0.0012"}], ",", " ", 
     RowBox[{"\[Alpha]", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"c", "\[Rule]", "2"}], ",", " ", 
     RowBox[{"V", "\[Rule]", " ", 
      RowBox[{"Function", "[", 
       RowBox[{"s", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "-", "1"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"s", "+", "1.5"}], ")"}]}]}], "]"}]}]}], "}"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.792186316328789*^9, 3.792186367272459*^9}, {
   3.7922029847649937`*^9, 3.7922030225499187`*^9}, {3.7923671010317698`*^9, 
   3.792367108318389*^9}, {3.7923672145199337`*^9, 3.79236721470516*^9}, {
   3.7923673451446505`*^9, 3.792367348318165*^9}, 3.792368451503528*^9, {
   3.792379781659352*^9, 3.7923798143170524`*^9}, {3.7923803704218082`*^9, 
   3.7923804001685505`*^9}, {3.7924313253129673`*^9, 3.792431332157443*^9}, {
   3.7924327480641356`*^9, 3.7924327507948523`*^9}, {3.792433359867727*^9, 
   3.792433362596465*^9}, {3.7928827013424263`*^9, 3.792882705265246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h", "\[Rule]", " ", "1"}], ",", 
    RowBox[{"\[Alpha]", "\[Rule]", " ", "alpha"}], ",", " ", 
    RowBox[{"V", "\[Rule]", " ", 
     RowBox[{"Function", "[", 
      RowBox[{"a", ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Subscript", "[", 
            RowBox[{"v", ",", "r"}], "]"}], "/", 
           RowBox[{"Factorial", "[", "r", "]"}]}], " ", 
          RowBox[{"a", "^", "r"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.7928827084832344`*^9, 3.7928828286286716`*^9}, {
   3.7928832350351887`*^9, 3.792883241103074*^9}, 3.792883481993333*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"h", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Alpha]", "\[Rule]", "alpha"}], ",", 
   RowBox[{"V", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{"a", ",", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"r", "=", "1"}], "4"], 
       FractionBox[
        RowBox[{
         SubscriptBox["v", "r"], " ", 
         SuperscriptBox["a", "r"]}], 
        RowBox[{"r", "!"}]]}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.792882829412181*^9, 3.7928832459329753`*^9, 
  3.792883503511679*^9, 3.792883546072877*^9, 3.792884813137003*^9, 
  3.7928899478636017`*^9, 3.792892661712473*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matlabCompatible2", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "\[Rule]", 
     RowBox[{"q", "[", "1", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["q", "2"], "\[Rule]", 
     RowBox[{"q", "[", "2", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["p", "1"], "\[Rule]", " ", 
     RowBox[{"p", "[", "1", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["p", "2"], "->", " ", 
     RowBox[{"p", "[", "2", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"v", ",", "r_"}], "]"}], "\[Rule]", " ", 
     RowBox[{"v", "[", "r", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7928825397454586`*^9, 3.7928825430415597`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["q", "1"], "\[Rule]", 
    RowBox[{"q", "[", "1", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["q", "2"], "\[Rule]", 
    RowBox[{"q", "[", "2", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["p", "1"], "\[Rule]", 
    RowBox[{"p", "[", "1", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["p", "2"], "\[Rule]", 
    RowBox[{"p", "[", "2", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["v", "r_"], "\[Rule]", 
    RowBox[{"v", "[", "r", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7921846979520407`*^9, 3.7921863756470537`*^9, 3.792188178302305*^9, {
   3.7921882526454325`*^9, 3.79218826727131*^9}, 3.792188862935974*^9, 
   3.7921891663021717`*^9, 3.792203048003824*^9, {3.792292708006732*^9, 
   3.792292734582218*^9}, 3.7923552757357054`*^9, 3.792363218470182*^9, 
   3.7923661825778255`*^9, 3.7923671178763933`*^9, 3.792367354584446*^9, 
   3.792368458909643*^9, 3.792371087640444*^9, 3.7923797566419787`*^9, 
   3.7923798192846327`*^9, {3.792380382441481*^9, 3.792380406536258*^9}, 
   3.792429981362541*^9, {3.7924303806413536`*^9, 3.7924304056918497`*^9}, 
   3.7924313403919053`*^9, 3.7924320949213257`*^9, 3.792432754176839*^9, 
   3.792433368286605*^9, 3.792433447387513*^9, 3.792880567727622*^9, 
   3.792882546808219*^9, 3.7928828457460527`*^9, 3.7928832459641924`*^9, 
   3.792883546088498*^9, 3.7928926617280684`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matlabCompatibleZ", " ", "=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     SubscriptBox["q", "1"], "\[Rule]", 
     RowBox[{"z", "[", "1", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["q", "2"], "\[Rule]", 
     RowBox[{"z", "[", "2", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["p", "1"], "\[Rule]", " ", 
     RowBox[{"z", "[", "3", "]"}]}], ",", 
    RowBox[{
     SubscriptBox["p", "2"], "->", " ", 
     RowBox[{"z", "[", "4", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"v", ",", "r_"}], "]"}], "\[Rule]", " ", 
     RowBox[{"v", "[", "r", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7921847371372128`*^9, 3.792184799564165*^9}, {
  3.7928825249601393`*^9, 3.7928825313988533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["q", "1"], "\[Rule]", 
    RowBox[{"z", "[", "1", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["q", "2"], "\[Rule]", 
    RowBox[{"z", "[", "2", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["p", "1"], "\[Rule]", 
    RowBox[{"z", "[", "3", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["p", "2"], "\[Rule]", 
    RowBox[{"z", "[", "4", "]"}]}], ",", 
   RowBox[{
    SubscriptBox["v", "r_"], "\[Rule]", 
    RowBox[{"v", "[", "r", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7921848010930557`*^9, 3.792186375678971*^9, 3.7921881783252473`*^9, {
   3.792188252668374*^9, 3.7921882672962427`*^9}, 3.792188862953954*^9, 
   3.79218916632312*^9, 3.792203048037731*^9, {3.792292709574443*^9, 
   3.7922927345978355`*^9}, 3.792355275782587*^9, 3.7923632185014243`*^9, 
   3.7923661826090965`*^9, 3.792367117938877*^9, 3.7923673547094154`*^9, 
   3.7923684589877496`*^9, 3.7923710876716733`*^9, 3.792379756673221*^9, 
   3.792379819331518*^9, {3.792380382472715*^9, 3.792380406575777*^9}, 
   3.7924299813781743`*^9, {3.792430380656975*^9, 3.7924304057230844`*^9}, 
   3.7924313404231763`*^9, 3.7924320949483805`*^9, 3.792432754208082*^9, 
   3.792433368302226*^9, 3.7924334474187555`*^9, 3.7928805688367634`*^9, {
   3.7928825335231676`*^9, 3.7928825482766*^9}, 3.792882847073865*^9, 
   3.7928832459798393`*^9, 3.7928835461197405`*^9, 3.792892661759339*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "Hqp", "]"}]], "Input",
 CellChangeTimes->{{3.792184666741578*^9, 3.7921846744499283`*^9}, {
  3.792880707043491*^9, 3.792880711856837*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SubsuperscriptBox["p", "1", "2"], "+", 
   SubsuperscriptBox["p", "2", "2"], "-", 
   RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
    SubscriptBox["p", "2"], " ", 
    SubscriptBox["q", "1"]}], "+", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], " ", 
    SubsuperscriptBox["q", "1", "2"]}], "+", 
   RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
    SubscriptBox["p", "1"], " ", 
    SubscriptBox["q", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], " ", 
    SubsuperscriptBox["q", "2", "2"]}], "+", 
   RowBox[{"V", "[", 
    RowBox[{
     SubsuperscriptBox["q", "1", "2"], "+", 
     SubsuperscriptBox["q", "2", "2"]}], "]"}], "-", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", 
    RowBox[{"V", "[", 
     RowBox[{
      SubsuperscriptBox["q", "1", "2"], "+", 
      SubsuperscriptBox["q", "2", "2"]}], "]"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c", "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.792184667972288*^9, 3.792186375716862*^9, 3.7921881783571496`*^9, {
   3.7921882526923075`*^9, 3.7921882673211775`*^9}, 3.7921888629778624`*^9, 
   3.7921891663470535`*^9, 3.7922030480726376`*^9, 3.792292734644699*^9, 
   3.7923552758450556`*^9, 3.7923632185326676`*^9, 3.7923661826403356`*^9, 
   3.792367118016982*^9, 3.792367354756302*^9, 3.7923684590502405`*^9, 
   3.792371087718537*^9, 3.792379756720085*^9, 3.7923798193627377`*^9, {
   3.7923803825039663`*^9, 3.7923804066040845`*^9}, 3.7924299814094048`*^9, {
   3.7924303806725955`*^9, 3.792430405754328*^9}, 3.7924313404387693`*^9, 
   3.7924320949796247`*^9, 3.7924327542393374`*^9, 3.7924333683334684`*^9, 
   3.792433447434377*^9, 3.79288056988339*^9, 3.7928807124346075`*^9, 
   3.7928825496044054`*^9, 3.7928828492608194`*^9, 3.7928832460110846`*^9, 
   3.79288354615101*^9, 3.7928926617905807`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matH", "=", 
  RowBox[{"ToMatlab", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Hqp", "/.", "data"}], "/.", "matlabCompatibleZ"}], "]"}], ",", 
    "600"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7921848165995417`*^9, 3.7921848727622843`*^9}, {
   3.792186487058009*^9, 3.7921864910244036`*^9}, 3.792882598678706*^9, {
   3.792882862858766*^9, 3.792882864170961*^9}}],

Cell[BoxData["\<\"(1/2).*((-1)+c.^2).^(-1).*(alpha.^2.*z(1).^2+alpha.^2.*z(2).\
^2+v(1).*(z(1).^2+z(2).^2)+(1/2).*v(2).*(z(1).^2+z(2).^2).^2+(1/6).*v(3).*(z(\
1).^2+z(2).^2).^3+(1/24).*v(4).*(z(1).^2+z(2).^2).^4+(-1/24).*c.^2.*(z(1).^2+\
z(2).^2).*(24.*v(1)+(z(1).^2+z(2).^2).*(12.*v(2)+(z(1).^2+z(2).^2).*(4.*v(3)+\
v(4).*(z(1).^2+z(2).^2))))+2.*alpha.*c.*z(2).*z(3)+z(3).^2+(-2).*alpha.*c.*z(\
1).*z(4)+z(4).^2);\\n\"\>"], "Output",
 CellChangeTimes->{{3.7921848664282284`*^9, 3.792184873352702*^9}, 
   3.7921863757817264`*^9, 3.792186491467216*^9, 3.7921881783850746`*^9, {
   3.7921882527162437`*^9, 3.7921882673441153`*^9}, 3.7921888629988065`*^9, 
   3.7921891663679967`*^9, 3.792203048150402*^9, 3.7922927347071843`*^9, 
   3.7923552759700513`*^9, 3.7923632186107745`*^9, 3.7923661826871767`*^9, 
   3.7923671180638437`*^9, 3.792367354787521*^9, 3.7923684591127424`*^9, 
   3.79237108774978*^9, 3.7923797567669487`*^9, 3.792379819409603*^9, {
   3.7923803825352*^9, 3.792380406633853*^9}, 3.792429981425026*^9, {
   3.792430380688216*^9, 3.792430405769949*^9}, 3.792431340470011*^9, 
   3.792432095010867*^9, 3.7924327542549458`*^9, 3.792433368364711*^9, 
   3.792433447465619*^9, 3.792881759780423*^9, 3.7928825515127707`*^9, 
   3.792882600053355*^9, {3.792882850340623*^9, 3.792882864873721*^9}, 
   3.7928832461038666`*^9, 3.7928835462290974`*^9, {3.7928847956924095`*^9, 
   3.7928848216649456`*^9}, 3.7928926618686867`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matHq", " ", "=", 
  RowBox[{"ToMatlab", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Hqp", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["q", "1"], ",", 
            SubscriptBox["q", "2"]}], "}"}], "}"}]}], "]"}], "/.", "data"}], "/.",
       "matlabCompatible2"}], "]"}], ",", "600"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792184981298431*^9, 3.7921850481745176`*^9}, {
   3.7921864001704698`*^9, 3.79218640573458*^9}, {3.7921865528868647`*^9, 
   3.792186559957946*^9}, 3.7928826457340364`*^9, {3.7928826828666544`*^9, 
   3.7928826840539227`*^9}}],

Cell[BoxData["\<\"[(-1/6).*((-1)+c.^2).^(-1).*(6.*alpha.*c.*p(2)+(-6).*alpha.^\
2.*q(1)+((-1)+c.^2).*q(1).*(6.*v(1)+(q(1).^2+q(2).^2).*(6.*v(2)+(q(1).^2+q(2).\
^2).*(3.*v(3)+(q(1).^2+q(2).^2).*v(4))))),(1/6).*((-1)+c.^2).^(-1).*(6.*alpha.\
*c.*p(1)+6.*alpha.^2.*q(2)+(-1).*((-1)+c.^2).*q(2).*(6.*v(1)+(q(1).^2+q(2).^2)\
.*(6.*v(2)+(q(1).^2+q(2).^2).*(3.*v(3)+(q(1).^2+q(2).^2).*v(4)))))];\\n\"\>"],\
 "Output",
 CellChangeTimes->{
  3.792185004675877*^9, 3.79218504860433*^9, 3.7921863758136034`*^9, 
   3.7921864071597385`*^9, 3.792186561137851*^9, 3.7921881784120026`*^9, {
   3.7921882527391815`*^9, 3.792188267366102*^9}, 3.792188863017783*^9, 
   3.7921891663879404`*^9, 3.792203048321975*^9, 3.792292734866624*^9, 
   3.7923552761418767`*^9, 3.7923632187670293`*^9, 3.7923661828433933`*^9, 
   3.7923671181263275`*^9, 3.7923673548500056`*^9, 3.792368459175206*^9, 
   3.792371087796644*^9, 3.7923797567981915`*^9, 3.79237981950333*^9, 
   3.7923803418030014`*^9, {3.792380382597686*^9, 3.7923804066651335`*^9}, 
   3.792429981440647*^9, {3.7924303807038383`*^9, 3.7924304057855806`*^9}, 
   3.7924313405012865`*^9, 3.7924320950421095`*^9, 3.792432754286188*^9, 
   3.792433368380333*^9, 3.7924334474812407`*^9, 3.7928817651253395`*^9, 
   3.7928826480639763`*^9, 3.792882684741209*^9, 3.792882866813921*^9, 
   3.7928832461819725`*^9, 3.7928835463071966`*^9, 3.7928926619467936`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matHp", "=", 
  RowBox[{"ToMatlab", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Hqp", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["p", "1"], ",", 
            SubscriptBox["p", "2"]}], "}"}], "}"}]}], "]"}], "/.", "data"}], "/.",
       "matlabCompatible2"}], "]"}], ",", "600"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7921850900085692`*^9, 3.792185094997228*^9}, {
  3.79218641328638*^9, 3.792186417360477*^9}, {3.7921865823989096`*^9, 
  3.7921865861738396`*^9}}],

Cell[BoxData["\<\"[((-1)+c.^2).^(-1).*(p(1)+alpha.*c.*q(2)),((-1)+c.^2).^(-1).\
*(p(2)+(-1).*alpha.*c.*q(1))];\\n\"\>"], "Output",
 CellChangeTimes->{
  3.792185097344941*^9, 3.7921863758475456`*^9, 3.7921864177244883`*^9, 
   3.792186587264891*^9, 3.792188178440925*^9, {3.7921882527591286`*^9, 
   3.7921882673850393`*^9}, 3.7921888630526624`*^9, 3.7921891664099407`*^9, 
   3.792203048351863*^9, 3.7922927349391713`*^9, 3.792355276204349*^9, 
   3.792363218876337*^9, 3.7923661829371247`*^9, 3.792367118173191*^9, 
   3.792367354896869*^9, 3.7923684593782835`*^9, 3.792371087827886*^9, 
   3.7923797568294344`*^9, 3.792379819534572*^9, {3.792380382628928*^9, 
   3.7923804066963377`*^9}, 3.7924299814562683`*^9, {3.7924303807194595`*^9, 
   3.792430405801206*^9}, 3.7924313405324965`*^9, 3.7924320950577307`*^9, 
   3.7924327543174314`*^9, 3.7924333684115753`*^9, 3.7924334474968615`*^9, 
   3.792881766953003*^9, 3.79288287087766*^9, 3.792883246213216*^9, 
   3.7928835463389473`*^9, 3.7928926619624233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Hqp", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["q", "1"], ",", 
             SubscriptBox["q", "2"]}], "}"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["p", "1"], ",", 
           SubscriptBox["p", "2"]}], "}"}], "}"}]}], "]"}], "/.", "data"}], "/.",
      "matlabCompatible2"}], "]"}], ",", "600"}], "]"}]], "Input",
 CellChangeTimes->{{3.7921852913228955`*^9, 3.7921853197906866`*^9}, {
  3.7921864228338056`*^9, 3.792186427536259*^9}}],

Cell[BoxData["\<\"[0,(-1).*alpha.*c.*((-1)+c.^2).^(-1);alpha.*c.*((-1)+c.^2).^\
(-1),0];\\n\"\>"], "Output",
 CellChangeTimes->{{3.7921853013720465`*^9, 3.7921853209824963`*^9}, 
   3.7921863758774643`*^9, 3.792186427953134*^9, 3.792188178469853*^9, {
   3.7921882527810698`*^9, 3.7921882674089727`*^9}, 3.7921888630805874`*^9, 
   3.792189166436838*^9, 3.7922030483817835`*^9, 3.7922927349704194`*^9, 
   3.7923552762668343`*^9, 3.7923632189075794`*^9, 3.7923661829683943`*^9, 
   3.7923671182200537`*^9, 3.7923673549437637`*^9, 3.7923684594251475`*^9, 
   3.7923710878591547`*^9, 3.7923797568606772`*^9, 3.792379819581437*^9, {
   3.7923803826601696`*^9, 3.7923804067276015`*^9}, 3.7924299814718933`*^9, {
   3.7924303807350845`*^9, 3.7924304058324423`*^9}, 3.7924313405481176`*^9, 
   3.7924320950889735`*^9, 3.792432754348673*^9, 3.792433368427196*^9, 
   3.792433447528105*^9, 3.792881768390192*^9, 3.792882879611785*^9, 
   3.7928832462444973`*^9, 3.7928835463649445`*^9, 3.7928926619936543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"F", "/.", "data"}], "/.", "matlabCompatibleZ"}], "]"}], ",", 
   "60000"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7922030908482246`*^9, {3.792203609461938*^9, 3.792203611084628*^9}, {
   3.7923632407224765`*^9, 3.7923632760635347`*^9}, {3.792380512548291*^9, 
   3.792380514086903*^9}}],

Cell[BoxData["\<\"[((-1)+c.^2).^(-1).*(alpha.*c.*z(2)+z(3)),((-1)+c.^2).^(-1).\
*((-1).*alpha.*c.*z(1)+z(4)),alpha.*c.*((-1)+c.^2).^(-1).*(alpha.*c.*z(1)+(-1)\
.*z(4))+(1/12).*((-1)+c.^2).^(-4).*(z(1).*(alpha.^2.*(12+(-24).*c.^2+24.*c.^6+\
(-12).*c.^8+(-1).*alpha.^2.*dt.^2+(-6).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*\
c.^4.*dt.^2+alpha.^2.*dx.^2+6.*alpha.^2.*c.^2.*dx.^2+alpha.^2.*c.^4.*dx.^2+2.*\
((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)\
+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).\
*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-\
2).*((-1)+c.^2).*(6+(-18).*c.^2+18.*c.^4+(-6).*c.^6+(-3).*alpha.^2.*c.^2.*dt.^\
2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+3.*alpha.^2.*c.^2.*dx.^2+((-1)+\
c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2)\
.*v(4).*(z(1).^2+z(2).^2).^2)+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.\
*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)).*(v(1)+(1/\
6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(\
2).^2))))+(-1).*((-1)+c.^2).^2.*(c.^4.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).\
^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2)))).^\
2+(-8).*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(2).*(v(2)+v(3).*(\
z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2).*z(3)+(-1).*((-1)+c.^2).*(\
c.^4.*dt.^2+(-1).*dx.^2).*(6.*v(2)+2.*v(3).*(5.*z(1).^2+3.*z(2).^2)+v(4).*(7.*\
z(1).^4+10.*z(1).^2.*z(2).^2+3.*z(2).^4)).*z(3).^2)+4.*(alpha.*c.*((-6)+(-18).\
*c.^4+6.*c.^6+alpha.^2.*dt.^2+(-1).*alpha.^2.*dx.^2+c.^2.*(18+alpha.^2.*(dt.^\
2+(-1).*dx.^2))+(-2).*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+\
v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-1).*alpha.*c.*((\
-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)\
+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(-1/2).*((-1)+c.^2).*(\
c.^4.*dt.^2+(-1).*dx.^2).*z(2).*(2.*v(2)+2.*v(3).*(3.*z(1).^2+z(2).^2)+v(4).*(\
5.*z(1).^4+6.*z(1).^2.*z(2).^2+z(2).^4)).*z(3)).*z(4)+(-1).*((-1)+c.^2).*(c.^\
4.*dt.^2+(-1).*dx.^2).*z(1).*(2.*v(2)+2.*v(3).*(z(1).^2+3.*z(2).^2)+v(4).*(z(\
1).^4+6.*z(1).^2.*z(2).^2+5.*z(2).^4)).*z(4).^2),(1/12).*((-1)+c.^2).^(-4).*((\
-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).*(2.*v(2)+2.*v(3).*(3.*z(1).\
^2+z(2).^2)+v(4).*(5.*z(1).^4+6.*z(1).^2.*z(2).^2+z(2).^4)).*z(3).^2+(-4).*z(\
3).*(alpha.*c.*((-3)+(-9).*c.^4+3.*c.^6+alpha.^2.*dt.^2+(-1).*alpha.^2.*dx.^2+\
c.^2.*(9+alpha.^2.*(dt.^2+(-1).*dx.^2))+(-2).*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*\
dx.^2).*z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).\
^2))+(-1).*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(\
1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2)))\
)+(1/2).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).*(2.*v(2)+2.*v(3).*(z(1)\
.^2+3.*z(2).^2)+v(4).*(z(1).^4+6.*z(1).^2.*z(2).^2+5.*z(2).^4)).*z(4))+z(2).*(\
alpha.^2.*(12+(-36).*c.^2+36.*c.^4+(-12).*c.^6+(-1).*alpha.^2.*dt.^2+(-6).*\
alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.*dx.^2+6.*alpha.^2.\
*c.^2.*dx.^2+alpha.^2.*c.^4.*dx.^2+2.*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*\
z(1).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+2.*(\
(-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+\
(1/2).*v(4).*(z(1).^2+z(2).^2).^2))+(-2).*((-1)+c.^2).*(6+(-18).*c.^2+18.*c.^\
4+(-6).*c.^6+(-3).*alpha.^2.*c.^2.*dt.^2+(-1).*alpha.^2.*c.^4.*dt.^2+alpha.^2.\
*dx.^2+3.*alpha.^2.*c.^2.*dx.^2+((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(1).^\
2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2).^2).^2)+((-1)+c.^\
2).*(c.^4.*dt.^2+(-1).*dx.^2).*z(2).^2.*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*\
v(4).*(z(1).^2+z(2).^2).^2)).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^\
2+z(2).^2).*(3.*v(3)+v(4).*(z(1).^2+z(2).^2))))+(-1).*((-1)+c.^2).^2.*(c.^4.*\
dt.^2+(-1).*dx.^2).*(v(1)+(1/6).*(z(1).^2+z(2).^2).*(6.*v(2)+(z(1).^2+z(2).^2)\
.*(3.*v(3)+v(4).*(z(1).^2+z(2).^2)))).^2+8.*alpha.*c.*((-1)+c.^2).*(c.^2.*dt.^\
2+(-1).*dx.^2).*z(1).*(v(2)+v(3).*(z(1).^2+z(2).^2)+(1/2).*v(4).*(z(1).^2+z(2)\
.^2).^2).*z(4)+(-1).*((-1)+c.^2).*(c.^4.*dt.^2+(-1).*dx.^2).*(6.*v(2)+2.*v(3).\
*(3.*z(1).^2+5.*z(2).^2)+v(4).*(3.*z(1).^4+10.*z(1).^2.*z(2).^2+7.*z(2).^4)).*\
z(4).^2))];\\n\"\>"], "Output",
 CellChangeTimes->{
  3.7923805149186645`*^9, 3.7924299814875116`*^9, {3.792430380750703*^9, 
   3.7924304058949194`*^9}, 3.792431340594995*^9, 3.7924320951229696`*^9, 
   3.7924327543799167`*^9, 3.792433368458439*^9, 3.7924334475437274`*^9, 
   3.7928817698273263`*^9, 3.792882884896579*^9, 3.792883248411703*^9, 
   3.792883547096393*^9, 3.7928926641494055`*^9}]
}, Open  ]],

Cell["\<\
modified conserved quantity up to order 4 terms - quadratic potentials only, \
V \[Rule] Function[a,Sum[1/Factorial[j]Subscript[v,j] a^j,{j,0,2}]]\
\>", "Text",
 CellChangeTimes->{{3.7923787389467545`*^9, 3.792378767148489*^9}, {
  3.792881989199506*^9, 3.792881989841522*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"modI", " ", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"24", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["c", "2"]}], ")"}], "3"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "12"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["p", "1", "2"], "+", 
         SubsuperscriptBox["p", "2", "2"], "-", 
         RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
          SubscriptBox["p", "2"], " ", 
          SubscriptBox["q", "1"]}], "+", 
         RowBox[{"2", " ", "c", " ", "\[Alpha]", " ", 
          SubscriptBox["p", "1"], " ", 
          SubscriptBox["q", "2"]}], "-", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["q", "1", "2"], "+", 
            SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["\[Alpha]", "2"]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             SubscriptBox["v", "1"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             SubsuperscriptBox["q", "1", "2"], " ", 
             SubscriptBox["v", "2"]}], "-", 
            RowBox[{
             SubsuperscriptBox["q", "2", "2"], " ", 
             SubscriptBox["v", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             SubsuperscriptBox["q", "2", "2"], " ", 
             SubscriptBox["v", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["h", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["q", "1", "2"], "+", 
         SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "4"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "4"]}], "-", 
         RowBox[{
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "4"]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "4"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "4"], " ", 
             SuperscriptBox["dt", "2"]}], "-", 
            SuperscriptBox["dx", "2"]}], ")"}], " ", 
          SubsuperscriptBox["v", "1", "2"]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["c", "4"]}], " ", 
             SuperscriptBox["dt", "2"]}], "+", 
            SuperscriptBox["dx", "2"]}], ")"}], " ", 
          SubsuperscriptBox["p", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["p", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["p", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["c", "3"], " ", 
          SuperscriptBox["dt", "2"], " ", "\[Alpha]", " ", 
          SubscriptBox["p", "2"], " ", 
          SubscriptBox["q", "1"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["c", "5"], " ", 
          SuperscriptBox["dt", "2"], " ", "\[Alpha]", " ", 
          SubscriptBox["p", "2"], " ", 
          SubscriptBox["q", "1"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{"12", " ", "c", " ", 
          SuperscriptBox["dx", "2"], " ", "\[Alpha]", " ", 
          SubscriptBox["p", "2"], " ", 
          SubscriptBox["q", "1"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{"7", " ", 
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{"4", " ", "c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["c", "2"], " ", 
             SuperscriptBox["dt", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["c", "4"], " ", 
             SuperscriptBox["dt", "2"]}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["dx", "2"]}]}], ")"}], " ", "\[Alpha]", " ", 
          SubscriptBox["p", "1"], " ", 
          SubscriptBox["q", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{"7", " ", 
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SuperscriptBox["\[Alpha]", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubscriptBox["v", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "1", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["c", "6"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "1", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "1", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "1", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "6"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "2", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["c", "6"], " ", 
          SuperscriptBox["dt", "2"], " ", 
          SubsuperscriptBox["q", "2", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "2", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dx", "2"], " ", 
          SubsuperscriptBox["q", "2", "4"], " ", 
          SubsuperscriptBox["v", "2", "2"]}], "+", 
         RowBox[{
          SubscriptBox["v", "1"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c", "4"], " ", 
                SuperscriptBox["dt", "2"]}], "+", 
               SuperscriptBox["dx", "2"], "+", 
               RowBox[{
                SuperscriptBox["c", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "3"}], " ", 
                   SuperscriptBox["dt", "2"]}], "+", 
                  SuperscriptBox["dx", "2"]}], ")"}]}]}], ")"}], " ", 
             SuperscriptBox["\[Alpha]", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c", "4"], " ", 
                SuperscriptBox["dt", "2"]}], "-", 
               SuperscriptBox["dx", "2"]}], ")"}], " ", 
             SubsuperscriptBox["q", "1", "2"], " ", 
             SubscriptBox["v", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["c", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c", "4"], " ", 
                SuperscriptBox["dt", "2"]}], "-", 
               SuperscriptBox["dx", "2"]}], ")"}], " ", 
             SubsuperscriptBox["q", "2", "2"], " ", 
             SubscriptBox["v", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7928898479458647`*^9, 3.7928898577434654`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"modI", ",", "h", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.792897392751033*^9, 3.792897404532902*^9}, {
  3.792897447398197*^9, 3.7928974732839537`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"24", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c", "2"]}], ")"}], "3"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["q", "1", "2"], "+", 
      SubsuperscriptBox["q", "2", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "4"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "4"]}], "-", 
      RowBox[{
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "4"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "4"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"]}], "-", 
         SuperscriptBox["dx", "2"]}], ")"}], " ", 
       SubsuperscriptBox["v", "1", "2"]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "4"]}], " ", 
          SuperscriptBox["dt", "2"]}], "+", 
         SuperscriptBox["dx", "2"]}], ")"}], " ", 
       SubsuperscriptBox["p", "1", "2"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["p", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["p", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["c", "3"], " ", 
       SuperscriptBox["dt", "2"], " ", "\[Alpha]", " ", 
       SubscriptBox["p", "2"], " ", 
       SubscriptBox["q", "1"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["c", "5"], " ", 
       SuperscriptBox["dt", "2"], " ", "\[Alpha]", " ", 
       SubscriptBox["p", "2"], " ", 
       SubscriptBox["q", "1"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{"12", " ", "c", " ", 
       SuperscriptBox["dx", "2"], " ", "\[Alpha]", " ", 
       SubscriptBox["p", "2"], " ", 
       SubscriptBox["q", "1"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{"7", " ", 
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{"4", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["dt", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["dt", "2"]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["dx", "2"]}]}], ")"}], " ", "\[Alpha]", " ", 
       SubscriptBox["p", "1"], " ", 
       SubscriptBox["q", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{"7", " ", 
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubscriptBox["v", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "1", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["c", "6"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "1", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "1", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "1", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "6"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "1", "2"], " ", 
       SubsuperscriptBox["q", "2", "2"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "2", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["c", "6"], " ", 
       SuperscriptBox["dt", "2"], " ", 
       SubsuperscriptBox["q", "2", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "2", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       SuperscriptBox["dx", "2"], " ", 
       SubsuperscriptBox["q", "2", "4"], " ", 
       SubsuperscriptBox["v", "2", "2"]}], "+", 
      RowBox[{
       SubscriptBox["v", "1"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "4"], " ", 
             SuperscriptBox["dt", "2"]}], "+", 
            SuperscriptBox["dx", "2"], "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], " ", 
                SuperscriptBox["dt", "2"]}], "+", 
               SuperscriptBox["dx", "2"]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["\[Alpha]", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "4"], " ", 
             SuperscriptBox["dt", "2"]}], "-", 
            SuperscriptBox["dx", "2"]}], ")"}], " ", 
          SubsuperscriptBox["q", "1", "2"], " ", 
          SubscriptBox["v", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "4"], " ", 
             SuperscriptBox["dt", "2"]}], "-", 
            SuperscriptBox["dx", "2"]}], ")"}], " ", 
          SubsuperscriptBox["q", "2", "2"], " ", 
          SubscriptBox["v", "2"]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.7928974051889677`*^9, {3.792897448479564*^9, 3.7928974744432755`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"modI", "/.", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["v", "0"], "\[Rule]", "0"}], "}"}]}], "/.", "data"}], "/.",
      "matlabCompatibleZ"}], "]"}], ",", "1000"}], "]"}]], "Input",
 CellChangeTimes->{{3.792882366941886*^9, 3.7928824012603073`*^9}, {
  3.792882512846078*^9, 3.79288251373672*^9}, {3.792882922589808*^9, 
  3.7928829342321444`*^9}, {3.7928836790714617`*^9, 3.7928836944595537`*^9}, {
  3.792889900342069*^9, 3.7928899010341325`*^9}}],

Cell[BoxData["\<\"(1/24).*(1+(-1).*c.^2).^(-3).*((-12).*((-1)+c.^2).^2.*((-1/\
2).*(z(1).^2+z(2).^2).*((-2).*alpha.^2+((-1)+c.^2).*(2.*v(1)+v(2).*(z(1).^2+z(\
2).^2)))+2.*alpha.*c.*z(2).*z(3)+z(3).^2+(-2).*alpha.*c.*z(1).*z(4)+z(4).^2)+(\
z(1).^2+z(2).^2).*(alpha.^4.*(1+3.*c.^2).*(dt.^2+(-1).*dx.^2)+alpha.^2.*(dx.^\
2.*((-2).*v(1)+v(2).*(z(1).^2+z(2).^2))+(-1).*c.^4.*dt.^2.*(2.*v(1)+7.*v(2).*(\
z(1).^2+z(2).^2))+c.^2.*(3.*dt.^2.*(2.*v(1)+v(2).*(z(1).^2+z(2).^2))+dx.^2.*((\
-2).*v(1)+3.*v(2).*(z(1).^2+z(2).^2))))+(-4).*alpha.*c.*(2.*c.^2.*dt.^2+c.^4.*\
dt.^2+(-3).*dx.^2).*v(2).*(z(2).*z(3)+(-1).*z(1).*z(4))+(-1).*(c.^4.*dt.^2+(-\
1).*dx.^2).*(((-1)+c.^2).*v(1).^2+(-1).*((-1)+c.^2).*v(1).*v(2).*(z(1).^2+z(2)\
.^2)+v(2).*((-1).*((-1)+c.^2).*v(2).*(z(1).^2+z(2).^2).^2+6.*(z(3).^2+z(4).^2)\
))));\\n\"\>"], "Output",
 CellChangeTimes->{
  3.7928829354682264`*^9, 3.7928832487589865`*^9, 3.792883547424441*^9, 
   3.7928837175118065`*^9, 3.7928853912118073`*^9, {3.7928898949305434`*^9, 
   3.792889901502738*^9}, 3.7928899537213593`*^9, 3.7928926646023936`*^9}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 313, 10, 30, "Input"],
Cell[CellGroupData[{
Cell[896, 34, 127, 2, 30, "Input"],
Cell[1026, 38, 1281, 28, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2344, 71, 934, 27, 30, "Input"],
Cell[3281, 100, 1595, 38, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4913, 143, 940, 28, 30, "Input"],
Cell[5856, 173, 1579, 38, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7472, 216, 497, 16, 30, "Input"],
Cell[7972, 234, 1630, 39, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9639, 278, 1082, 34, 30, "Input"],
Cell[10724, 314, 1859, 43, 52, "Output"]
}, Open  ]],
Cell[12598, 360, 452, 13, 30, "Input"],
Cell[13053, 375, 321, 9, 30, "Input"],
Cell[13377, 386, 526, 14, 30, "Input"],
Cell[CellGroupData[{
Cell[13928, 404, 382, 10, 30, "Input"],
Cell[14313, 416, 2277, 61, 30, "Output"]
}, Open  ]],
Cell[16605, 480, 1829, 55, 30, "Input"],
Cell[18437, 537, 1515, 37, 30, "Input"],
Cell[CellGroupData[{
Cell[19977, 578, 970, 28, 30, "Input"],
Cell[20950, 608, 1636, 38, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22623, 651, 709, 20, 30, "Input"],
Cell[23335, 673, 1684, 39, 47, "Output"]
}, Open  ]],
Cell[25034, 715, 707, 19, 30, "Input"],
Cell[25744, 736, 663, 19, 30, "Input"],
Cell[26410, 757, 834, 23, 30, "Input"],
Cell[27247, 782, 126, 2, 30, "Input"],
Cell[27376, 786, 1248, 26, 30, "Input"],
Cell[CellGroupData[{
Cell[28649, 816, 806, 21, 30, "Input"],
Cell[29458, 839, 664, 18, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30159, 862, 714, 20, 30, "Input"],
Cell[30876, 884, 1400, 30, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32313, 919, 765, 21, 30, "Input"],
Cell[33081, 942, 1426, 30, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34544, 977, 180, 3, 30, "Input"],
Cell[34727, 982, 1908, 44, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36672, 1031, 425, 10, 30, "Input"],
Cell[37100, 1043, 1437, 19, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38574, 1067, 707, 18, 30, "Input"],
Cell[39284, 1087, 1389, 19, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40710, 1111, 622, 17, 30, "Input"],
Cell[41335, 1130, 1012, 14, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42384, 1149, 761, 22, 30, "Input"],
Cell[43148, 1173, 1002, 13, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44187, 1191, 397, 10, 30, "Input"],
Cell[44587, 1203, 4779, 61, 373, "Output"]
}, Open  ]],
Cell[49381, 1267, 287, 5, 30, "Text"],
Cell[49671, 1274, 11631, 299, 155, "Input"],
Cell[CellGroupData[{
Cell[61327, 1577, 253, 5, 30, "Input"],
Cell[61583, 1584, 9068, 248, 129, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70688, 1837, 592, 14, 30, "Input"],
Cell[71283, 1853, 1067, 14, 107, "Output"]
}, Open  ]]
}
]
*)

