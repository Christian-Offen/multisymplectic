import numpy as jnp

def ode0(z,VdJet,a,c,dt,dx):

	# first order formulation of ODE
	
	# z = [u0,u1,ud0,ud1]
	u = z[:2]
	ud = z[2:]
	h = 1
	usq = u[0]**2+u[1]**2
	UVal = VdJet[1](usq)

	rhs = 1/(c**2 - 1)*((a**2 + UVal)*u + 2*c*a*jnp.array([ud[1],-ud[0]]))

	return jnp.concatenate([ud,rhs])


def ode2(z,VdJet,a,c,dt,dx):

	# first order formulation of modified ODE 2
	
	# z = [u0,u1,ud0,ud1]
	u = z[:2]
	ud = z[2:]
	h = 1
	usq = u[0]**2+u[1]**2
	UValJet = jnp.array([VdJet[1](usq),VdJet[2](usq),VdJet[3](usq)]) # derivatives of Vd at usq. Zeroth component is 1st dreivative

	rhs = jnp.array([(4*ud[1]*(6*a*c*(-1 + c**2)**3 + a**3*(c + c**3)*(dt - dx)*(dt + dx)*h**2 + (-1 + c**2)*h**2*(a*c*(-(c**2*dt**2) + dx**2)*UValJet[0] + u[1]*(a*c*(c**2*(-2 + c**2)*dt**2 + dx**2)*u[1] - (-1 + c**2)*(c**4*dt**2 - dx**2)*ud[0])*UValJet[1])) - 4*(-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[0]**2*ud[1]*(a*c*UValJet[1] + 2*(-1 + c**2)*u[1]*ud[0]*UValJet[2]) - 2*(-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[0]**3*((a**2 + UValJet[0])*UValJet[1] + 2*(-1 + c**2)*ud[0]**2*UValJet[2]) + u[0]*(12*a**2*(-1 + c**2)**3 + a**4*(1 + 3*c**2)*(dt - dx)*(dt + dx)*h**2 - (-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*UValJet[0]**2 + 2*UValJet[0]*(6*(-1 + c**2)**3 - a**2*(dx**2 + c**2*((-3 + c**2)*dt**2 + dx**2))*h**2 - (-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[1]**2*UValJet[1]) - 2*(-1 + c**2)*h**2*((a**2*(c**4*dt**2 - dx**2)*u[1]**2 - 4*a*c**3*(-1 + c**2)*dt**2*u[1]*ud[0] + (-1 + c**2)*(c**4*dt**2 - dx**2)*(3*ud[0]**2 + ud[1]**2))*UValJet[1] + 2*(-1 + c**2)*(c**4*dt**2 - dx**2)*u[1]**2*ud[1]**2*UValJet[2])))/(12.*(-1 + c**2)**4),(-4*ud[0]*(6*a*c*(-1 + c**2)**3 + a**3*(c + c**3)*(dt - dx)*(dt + dx)*h**2 + (-1 + c**2)*h**2*(a*c*(-(c**2*dt**2) + dx**2)*UValJet[0] + u[0]*(a*c*(c**2*(-2 + c**2)*dt**2 + dx**2)*u[0] + (-1 + c**2)*(c**4*dt**2 - dx**2)*ud[1])*UValJet[1])) + 4*(-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[1]**2*ud[0]*(a*c*UValJet[1] - 2*(-1 + c**2)*u[0]*ud[1]*UValJet[2]) - 2*(-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[1]**3*((a**2 + UValJet[0])*UValJet[1] + 2*(-1 + c**2)*ud[1]**2*UValJet[2]) + u[1]*(12*a**2*(-1 + c**2)**3 + a**4*(1 + 3*c**2)*(dt - dx)*(dt + dx)*h**2 - (-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*UValJet[0]**2 + 2*UValJet[0]*(6*(-1 + c**2)**3 - a**2*(dx**2 + c**2*((-3 + c**2)*dt**2 + dx**2))*h**2 - (-1 + c**2)*(c**4*dt**2 - dx**2)*h**2*u[0]**2*UValJet[1]) - 2*(-1 + c**2)*h**2*((a**2*(c**4*dt**2 - dx**2)*u[0]**2 + 4*a*c**3*(-1 + c**2)*dt**2*u[0]*ud[1] + (-1 + c**2)*(c**4*dt**2 - dx**2)*(ud[0]**2 + 3*ud[1]**2))*UValJet[1] + 2*(-1 + c**2)*(c**4*dt**2 - dx**2)*u[0]**2*ud[0]**2*UValJet[2])))/(12.*(-1 + c**2)**4)])



	return jnp.concatenate([ud,rhs])


def ode4(z,VdJet,a,c,dt,dx):

	# first order formulation of modified ODE 4
	
	# z = [u0,u1,ud0,ud1]
	u = z[:2]
	ud = z[2:]
	h = 1
	usq = u[0]**2+u[1]**2
	UValJet = jnp.array([VdJet[1](usq),VdJet[2](usq),VdJet[3](usq),VdJet[4](usq),VdJet[5](usq)]) # derivatives of Vd at usq. Zeroth component is 1st dreivative


	rhs = jnp.array([
	(2*ud[1]*(3*a*(120*c*(-1 + c**2)**6 + 20*a**2*(-1 + c**2)**3*(c + c**3)*dt**2 + a**4*(c + 14*c**3 + 21*c**5 + 4*c**7)*dt**4 - 5*a**2*(c + c**3)*(4*(-1 + c**2)**3 + a**2*(1 + 6*c**2 + c**4)*dt**2)*dx**2 + a**4*c*(4 + 21*c**2 + 14*c**4 + c**6)*dx**4) + (-1 + c**2)*(3*a*(-1 + c)*c*(1 + c)*(c*dt - dx)*(c*dt + dx)*(c**2*(1 + 4*c**2)*dt**2 - (4 + c**2)*dx**2)*UValJet[0]**2 - 2*UValJet[0]*(a*c*(c*dt - dx)*(c*dt + dx)*(5*(-6 + a**2*dt**2) + 3*c**2*(10*(3 - 3*c**2 + c**4) 
	+ a**2*(11 + 4*c**2)*dt**2) - a**2*(12 + 33*c**2 + 5*c**4)*dx**2) - (-1 + c**2)*u[1]*(a*c*(c**4*(33 + 71*c**2 - 19*c**4)*dt**4 - 5*c**2*(23 + 11*c**2)*dt**2*dx**2 + (63 + 22*c**2)*dx**4)*u[1]*UValJet[1] + (-1 + c)*(1 + c)*(c**6*(11 + 19*c**2)*dt**4 - 60*c**4*dt**2*dx**2 
	+ (19 + 11*c**2)*dx**4)*ud[0]*UValJet[1] + 6*a*c*(c**4*(3 + 5*c**2 - 3*c**4)*dt**4 
	- 10*c**2*dt**2*dx**2 + (4 + c**2)*dx**4)*u[1]**3*UValJet[2] + 6*(-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[1]**2*ud[0]*UValJet[2])) + 2*(3*a*c*(-1 + c**2)**2*(c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*(ud[0]**2 + ud[1]**2)*UValJet[1] + (-1 + c**2)*u[1]*ud[0]*(-((c**4*dt**2*(30*(-1 + c**2)**3 + a**2*(15 + 84*c**2 + 61*c**4)*dt**2) 
	- 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 20*c**2 + 9*c**4)*dt**2)*dx**2 + a**2*(19 + 108*c**2 + 33*c**4)*dx**4)*UValJet[1]) + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(ud[0]**2 + ud[1]**2)*UValJet[2]) + a*c*u[1]**2*((c**2*dt**2*(30*(-2 + c**2)*(-1 + c**2)**3 
	+ a**2*(-10 - 73*c**2 - 7*c**4 + 40*c**6)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*(1 + 29*c**2 + c**4 - 11*c**6)*dt**2)*dx**2 + a**2*(-63 - c**2 + 14*c**4)*dx**4)*UValJet[1] - 6*(-1 + c**2)**2*((c**4*(-3 - c**2 + 9*c**4)*dt**4 + 10*c**2*(1 - 2*c**2)*dt**2*dx**2 + (2 + 3*c**2)*dx**4)*ud[0]**2 + (3*c**4*(-2 - 4*c**2 + c**4)*dt**4 
	+ 10*c**2*(2 + c**2)*dt**2*dx**2 - (11 + 4*c**2)*dx**4)*ud[1]**2)*UValJet[2]) - 2*a*c*(-1 + c**2)*(c**4*(-3 - 5*c**2 + 3*c**4)*dt**4 + 10*c**2*dt**2*dx**2 - (4 + c**2)*dx**4)*u[1]**4*(UValJet[1]**2 + 3*a**2*UValJet[2] + 2*(-1 + c**2)*ud[1]**2*UValJet[3]) + 2*(-1 + c**2)*u[1]**3*ud[0]*((-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*UValJet[1]**2 + 3*a**2*(c**6*(-8 - 11*c**2 + 9*c**4)*dt**4 - 10*c**4*(-3 + c**2)*dt**2*dx**2 - (3 + 7*c**2)*dx**4)*UValJet[2] + 2*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[3])))) + 8*(-1 + c**2)**2*u[0]**4*ud[1]*(a*c*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[1]**2 + 10*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*u[1]*ud[0]*UValJet[1]*UValJet[2] + (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(3*a*c*(a**2 + UValJet[0])*UValJet[2] + 6*(-1 + c**2)*ud[0]*(a*c*ud[0] + u[1]*(a**2 + UValJet[0]))*UValJet[3] + 4*(-1 + c**2)**2*u[1]*ud[0]**3*UValJet[4])) 
	+ 2*(-1 + c**2)**2*u[0]**5*(2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*(a**2 + UValJet[0])*UValJet[1]**2 + 20*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 
	+ (2 + c**2)*dx**4)*ud[0]**2*UValJet[1]*UValJet[2] + (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(3*(a**2 + UValJet[0])**2*UValJet[2] + 4*(-1 + c**2)*ud[0]**2*(3*(a**2 + UValJet[0])*UValJet[3] + (-1 + c**2)*ud[0]**2*UValJet[4]))) + 4*(-1 + c**2)*u[0]**2*ud[1]*(2*(-1 + c**2)*u[1]*(a*c*(c**4*(3 + 6*c**2 + c**4)*dt**4 - 10*c**2*(1 + c**2)*dt**2*dx**2 + 2*(4 + c**2)*dx**4)*u[1] + (-1 + c**2)*(c**6*(12 + 23*c**2)*dt**4 - 70*c**4*dt**2*dx**2 
	+ (23 + 12*c**2)*dx**4)*ud[0])*UValJet[1]**2 + UValJet[1]*(a*c*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-29 - 65*c**2 + 44*c**4)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*(1 + 13*c**2 + 17*c**4 - 11*c**6)*dt**2)*dx**2 
	+ a**2*(-45 - 17*c**2 + 12*c**4)*dx**4) + a*c*(-1 + c**2)*(c**4*(9 + 37*c**2 + 19*c**4)*dt**4 - 5*c**2*(7 + 19*c**2)*dt**2*dx**2 + 5*(9 + 4*c**2)*dx**4)*UValJet[0] + 20*(-1 + c**2)**2*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*u[1]**3*ud[0]*UValJet[2]) 
	+ 2*(-1 + c**2)*(3*a*c*(-1 + c**2)*((c**4*(3 + 13*c**2 + 9*c**4)*dt**4 - 10*c**2*(1 + 4*c**2)*dt**2*dx**2 + (16 + 9*c**2)*dx**4)*ud[0]**2 + (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2)*UValJet[2] + u[1]*ud[0]*((c**4*dt**2*(-30*(-1 + c**2)**3 - a**2*(15 + 48*c**2 - 20*c**4 + 27*c**6)*dt**2) + 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 11*c**2)*dt**2)*dx**2 + a**2*(-46 - 27*c**2 + 3*c**4)*dx**4 + (-1 + c**2)*(c**6*(29 + 46*c**2)*dt**4 - 150*c**4*dt**2*dx**2 + (46 + 29*c**2)*dx**4)*UValJet[0])*UValJet[2] + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(2*ud[0]**2 + ud[1]**2)*UValJet[3]) 
	+ 3*a*c*u[1]**2*((c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*(a**2 + UValJet[0])*UValJet[2] - 2*(-1 + c**2)*((c**4*(-3 - c**2 + 9*c**4)*dt**4 + 10*c**2*(1 - 2*c**2)*dt**2*dx**2 + (2 + 3*c**2)*dx**4)*ud[0]**2 - (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (3 + 2*c**2)*dx**4)*ud[1]**2)*UValJet[3]) + 2*(-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[1]**3*ud[0]*(3*(a**2 + UValJet[0])*UValJet[3] + 2*(-1 + c**2)*ud[1]**2*UValJet[4]))) 
	+ (-1 + c**2)*u[0]**3*(4*(-1 + c**2)*(-2*a*c**3*(-1 + c**2)*dt**2*(c**2*(3 + 7*c**2)*dt**2 - 10*dx**2)*u[1]*ud[0] + (-1 + c**2)*(15*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[0]**2 + (c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*ud[1]**2) 
	+ 2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*u[1]**2*(a**2 + UValJet[0]))*UValJet[1]**2 + UValJet[1]*(a**2*(c**4*dt**2*(-60*(-1 + c**2)**3 + a**2*(-35 - 111*c**2 + 46*c**4)*dt**2) + 5*(12*(-1 + c**2)**3 + a**2*(1 + 15*c**2 + 33*c**4 - 9*c**6)*dt**2)*dx**2 + a**2*(-43 - 63*c**2 + 6*c**4)*dx**4) + 2*(c**4*dt**2*(-30*(-1 + c**2)**3 
	+ a**2*(-15 - 74*c**2 + 20*c**4 + 19*c**6)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 28*c**2 - 17*c**4)*dt**2)*dx**2 + a**2*(-43 - 21*c**2 + 14*c**4)*dx**4)*UValJet[0] + (-1 + c**2)*(c**6*(22 + 43*c**2)*dt**4 - 130*c**4*dt**2*dx**2 + (43 + 22*c**2)*dx**4)*UValJet[0]**2 + 40*(-1 + c**2)**2*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*u[1]**2*(ud[0]**2 + ud[1]**2)*UValJet[2]) + 4*(-1 + c**2)*(3*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*(a**2*(-1 + 3*c**2) + (-1 + c**2)*UValJet[0])*UValJet[2] + 10*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**4*UValJet[3] + ud[0]**2*((c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 78*c**2 - 4*c**4 + 27*c**6)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 - 23*c**2 + 12*c**4)*dt**2)*dx**2 
	+ a**2*(-64 - 27*c**2 + 21*c**4)*dx**4 + (-1 + c**2)*(c**6*(41 + 64*c**2)*dt**4 - 210*c**4*dt**2*dx**2 + (64 + 41*c**2)*dx**4)*UValJet[0])*UValJet[2] + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[3]) + 2*a*(-1 + c)*c*(1 + c)*u[1]*ud[0]*(-3*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*(a**2 + UValJet[0])*UValJet[2] - 2*((c**4*(-3 + c**2 + 12*c**4)*dt**4 + 10*c**2*(1 - 3*c**2)*dt**2*dx**2 
	+ 5*(1 + c**2)*dx**4)*ud[0]**2 - 6*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2)*UValJet[3]) + 3*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[1]**2*((a**2 + UValJet[0])**2*UValJet[2] 
	+ 2*(-1 + c**2)*((ud[0]**2 + ud[1]**2)*(a**2 + UValJet[0])*UValJet[3] + 2*(-1 + c**2)*ud[0]**2*ud[1]**2*UValJet[4])))) + u[0]*(a**2*(360 - 2160*c**10 + 360*c**12 + 90*c**8*(60 + a**2*(dt - dx)*(dt + dx)) + a**2*(dt - dx)*(dt + dx)*(-30 + a**2*(dt**2 - 4*dx**2)) + 3*c**2*(-720 + a**4*(8*dt**4 - 25*dt**2*dx**2 + 17*dx**4)) + 15*c**4*(360 + a**2*(dt - dx)*(dt + dx)*(12 + a**2*(5*dt**2 - 4*dx**2))) + 5*c**6*(-1440 + a**2*(dt - dx)*(dt + dx)*(-48 + a**2*(4*dt**2 - dx**2)))) + (-1 + c**2)**2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[0]**3 + (-1 + c**2)*UValJet[0]**2*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 67*c**2 + 12*c**4)*dt**2) 
	+ 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 16*c**2 + 3*c**4)*dt**2)*dx**2 - a**2*(12 + 49*c**2 + 9*c**4)*dx**4 + (-1 + c**2)*u[1]**2*((c**6*(22 + 43*c**2)*dt**4 - 130*c**4*dt**2*dx**2 + (43 + 22*c**2)*dx**4)*UValJet[1] + 6*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[1]**2*UValJet[2])) + UValJet[0]*(360 + c**2*(360*(-2 + c**2)*(3 - 3*c**2 + c**4)*(1 - c**2 + c**4) - 60*a**2*(-3 + c**2)*(-1 + c**2)**3*dt**2 + a**4*(15 + 130*c**2 + 11*c**4 - 36*c**6)*dt**4) 
	+ 5*a**2*(-12*(-1 + c**2)**3*(1 + c**2) 
	+ a**2*(-1 - 22*c**2 - 38*c**4 + 10*c**6 + 3*c**8)*dt**2)*dx**2 + a**4*(12 + 95*c**2 + 18*c**4 - 5*c**6)*dx**4 + 2*(-1 + c**2)*(-4*a*c*(-1 + c**2)*(c**4*(-12 - 17*c**2 + 19*c**4)*dt**4 - 20*c**2*(-2 + c**2)*dt**2*dx**2 - (9 + c**2)*dx**4)*u[1]*ud[0]*UValJet[1] + (-1 + c**2)**2*(c**6*(11 + 19*c**2)*dt**4 - 60*c**4*dt**2*dx**2 + (19 + 11*c**2)*dx**4)*(3*ud[0]**2 + ud[1]**2)*UValJet[1] - 12*a*c*(-1 + c**2)**2*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*u[1]**3*ud[0]*UValJet[2] 
	+ u[1]**2*((c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 74*c**2 + 20*c**4 + 19*c**6)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 28*c**2 - 17*c**4)*dt**2)*dx**2 + a**2*(-43 - 21*c**2 + 14*c**4)*dx**4)*UValJet[1] 
	+ 2*(-1 + c**2)**2*(9*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2 + (c**6*(29 + 46*c**2)*dt**4 - 150*c**4*dt**2*dx**2 + (46 + 29*c**2)*dx**4)*ud[1]**2)*UValJet[2]) + 2*(-1 + c**2)*u[1]**4*((c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[1]**2 + 3*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(a**2*UValJet[2] + 2*(-1 + c**2)*ud[1]**2*UValJet[3])))) 
	+ (-1 + c)*(1 + c)*(-8*a*c*(-1 + c**2)*u[1]*ud[0]*(-((c**2*dt**2*(30*(-1 + c**2)**3 
	+ a**2*(5 + 27*c**2 - 2*c**4)*dt**2) - 40*a**2*c**2*dt**2*dx**2 + a**2*(9 + c**2)*dx**4)*UValJet[1]) + 3*(-1 + c**2)*((c**4*(-3 + c**2 + 12*c**4)*dt**4 + 10*c**2*(1 - 3*c**2)*dt**2*dx**2 + 5*(1 + c**2)*dx**4)*ud[0]**2 - 3*(c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*ud[1]**2)*UValJet[2]) + 2*(-1 + c**2)*((c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 12*c**2 + 107*c**4)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 + 4*c**2 + 15*c**4)*dt**2)*dx**2 + a**2*(-19 + 60*c**2 + 39*c**4)*dx**4)*ud[1]**2*UValJet[1] 
	+ 15*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**4*UValJet[2] + 3*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**4*UValJet[2] + 3*ud[0]**2*(-((5*c**4*dt**2*(6*(-1 + c**2)**3 
	+ a**2*(3 + 12*c**2 + c**4)*dt**2) - 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 12*c**2 + c**4)*dt**2)*dx**2 + a**2*(19 + 52*c**2 + 9*c**4)*dx**4)*UValJet[1]) + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[2])) - 8*a*c*(-1 + c**2)**2*u[1]**3*ud[0]*((c**4*(3 + 7*c**2)*dt**4 - 10*c**2*dt**2*dx**2)*UValJet[1]**2 + 3*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*(a**2*UValJet[2] + 2*(-1 + c**2)*ud[1]**2*UValJet[3])) 
	+ u[1]**2*(a**2*(c**4*dt**2*(-60*(-1 + c**2)**3 + a**2*(-35 - 111*c**2 + 46*c**4)*dt**2) 
	+ 5*(12*(-1 + c**2)**3 + a**2*(1 + 15*c**2 + 33*c**4 - 9*c**6)*dt**2)*dx**2 + a**2*(-43 - 63*c**2 + 6*c**4)*dx**4)*UValJet[1] + 4*(-1 + c**2)**2*(5*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[0]**2 + (c**6*(11 + 24*c**2)*dt**4 - 70*c**4*dt**2*dx**2 
	+ (24 + 11*c**2)*dx**4)*ud[1]**2)*UValJet[1]**2 + 4*(-1 + c**2)*((c**4*dt**2*(-30*(-1 + c**2)**3 - a**2*(15 + 30*c**2 - 62*c**4 + 27*c**6)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 - 5*c**2 + 6*c**4)*dt**2)*dx**2 + a**2*(-46 + 15*c**2 + 21*c**4)*dx**4)*ud[1]**2*UValJet[2] 
	+ 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (3 + 2*c**2)*dx**4)*ud[1]**4*UValJet[3] + 3*ud[0]**2*(a**2*(c**6*(-18 - 19*c**2 + 27*c**4)*dt**4 + 10*c**4*(7 - 5*c**2)*dt**2*dx**2 + (-9 - 7*c**2 + 6*c**4)*dx**4)*UValJet[2] + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[3]))) + 2*(-1 + c**2)*u[1]**4*(2*a**2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[1]**2 + 20*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[1]**2*UValJet[1]*UValJet[2] 
	+ (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(3*a**4*UValJet[2] + 4*(-1 + c**2)*ud[1]**2*(3*a**2*UValJet[3] + (-1 + c**2)*ud[1]**2*UValJet[4]))))))/(360.*(-1 + c**2)**7),
	(-2*ud[0]*(3*a*(120*c*(-1 + c**2)**6 + 20*a**2*(-1 + c**2)**3*(c + c**3)*dt**2 + a**4*(c + 14*c**3 + 21*c**5 + 4*c**7)*dt**4 - 5*a**2*(c + c**3)*(4*(-1 + c**2)**3 + a**2*(1 + 6*c**2 + c**4)*dt**2)*dx**2 + a**4*c*(4 + 21*c**2 + 14*c**4 + c**6)*dx**4) - (-1 + c)*(1 + c)*(-3*a*(-1 + c)*c*(1 + c)*(c*dt - dx)*(c*dt + dx)*(c**2*(1 + 4*c**2)*dt**2 
	- (4 + c**2)*dx**2)*UValJet[0]**2 + 2*UValJet[0]*(a*c*(c*dt - dx)*(c*dt + dx)*(5*(-6 + a**2*dt**2) + 3*c**2*(10*(3 - 3*c**2 + c**4) + a**2*(11 + 4*c**2)*dt**2) - a**2*(12 + 33*c**2 + 5*c**4)*dx**2) + (-1 + c**2)*u[0]*(a*c*(c**4*(-33 - 71*c**2 + 19*c**4)*dt**4 + 5*c**2*(23 + 11*c**2)*dt**2*dx**2 - (63 + 22*c**2)*dx**4)*u[0]*UValJet[1] + (-1 + c**2)*(c**6*(11 + 19*c**2)*dt**4 - 60*c**4*dt**2*dx**2 + (19 + 11*c**2)*dx**4)*ud[1]*UValJet[1] + 6*a*c*(c**4*(-3 - 5*c**2 + 3*c**4)*dt**4 + 10*c**2*dt**2*dx**2 
	- (4 + c**2)*dx**4)*u[0]**3*UValJet[2] + 6*(-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[0]**2*ud[1]*UValJet[2])) + 2*(-3*a*c*(-1 + c**2)**2*(c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*(ud[0]**2 + ud[1]**2)*UValJet[1] + (-1 + c**2)*u[0]*ud[1]*(-((c**4*dt**2*(30*(-1 + c**2)**3 + a**2*(15 + 84*c**2 + 61*c**4)*dt**2) - 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 20*c**2 + 9*c**4)*dt**2)*dx**2 + a**2*(19 + 108*c**2 + 33*c**4)*dx**4)*UValJet[1]) + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(ud[0]**2 + ud[1]**2)*UValJet[2]) + a*c*u[0]**2*((c**2*dt**2*(-30*(-2 + c**2)*(-1 + c**2)**3 + a**2*(10 + 73*c**2 + 7*c**4 - 40*c**6)*dt**2) + 5*(-6*(-1 + c**2)**3 + a**2*(-1 - 29*c**2 - c**4 + 11*c**6)*dt**2)*dx**2 + a**2*(63 + c**2 - 14*c**4)*dx**4)*UValJet[1] 
	+ 6*(-1 + c**2)**2*((3*c**4*(-2 - 4*c**2 + c**4)*dt**4 + 10*c**2*(2 + c**2)*dt**2*dx**2 - (11 + 4*c**2)*dx**4)*ud[0]**2 + (c**4*(-3 - c**2 + 9*c**4)*dt**4 + 10*c**2*(1 - 2*c**2)*dt**2*dx**2 + (2 + 3*c**2)*dx**4)*ud[1]**2)*UValJet[2]) + 2*a*c*(-1 + c**2)*(c**4*(-3 - 5*c**2 + 3*c**4)*dt**4 + 10*c**2*dt**2*dx**2 - (4 + c**2)*dx**4)*u[0]**4*(UValJet[1]**2 + 3*a**2*UValJet[2] + 2*(-1 + c**2)*ud[0]**2*UValJet[3]) + 2*(-1 + c**2)*u[0]**3*ud[1]*((-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (3 + 2*c**2)*dx**4)*UValJet[1]**2 + 3*a**2*(c**6*(-8 - 11*c**2 + 9*c**4)*dt**4 - 10*c**4*(-3 + c**2)*dt**2*dx**2 - (3 + 7*c**2)*dx**4)*UValJet[2] + 2*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2*UValJet[3])))) - 8*(-1 + c**2)**2*u[1]**4*ud[0]*(a*c*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (4 + c**2)*dx**4)*UValJet[1]**2 - 10*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*u[0]*ud[1]*UValJet[1]*UValJet[2] + (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 
	+ (3 + 2*c**2)*dx**4)*(3*a*c*(a**2 + UValJet[0])*UValJet[2] + 6*(-1 + c**2)*ud[1]*(a*c*ud[1] - u[0]*(a**2 + UValJet[0]))*UValJet[3] - 4*(-1 + c**2)**2*u[0]*ud[1]**3*UValJet[4])) - 4*(-1 + c**2)*u[1]**2*ud[0]*(2*(-1 + c**2)*u[0]*(a*c*(c**4*(3 + 6*c**2 + c**4)*dt**4 - 10*c**2*(1 + c**2)*dt**2*dx**2 
	+ 2*(4 + c**2)*dx**4)*u[0] - (-1 + c**2)*(c**6*(12 + 23*c**2)*dt**4 
	- 70*c**4*dt**2*dx**2 + (23 + 12*c**2)*dx**4)*ud[1])*UValJet[1]**2 + UValJet[1]*(a*c*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-29 - 65*c**2 + 44*c**4)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*(1 + 13*c**2 + 17*c**4 - 11*c**6)*dt**2)*dx**2 + a**2*(-45 - 17*c**2 + 12*c**4)*dx**4) + a*c*(-1 + c**2)*(c**4*(9 + 37*c**2 + 19*c**4)*dt**4 - 5*c**2*(7 + 19*c**2)*dt**2*dx**2 + 5*(9 + 4*c**2)*dx**4)*UValJet[0] - 20*(-1 + c**2)**2*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 
	+ (2 + c**2)*dx**4)*u[0]**3*ud[1]*UValJet[2]) + 2*(-1 + c**2)*(3*a*c*(-1 + c**2)*((c**6*(2 + 3*c**2)*dt**4 
	- 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2 + (c**4*(3 + 13*c**2 + 9*c**4)*dt**4 - 10*c**2*(1 + 4*c**2)*dt**2*dx**2 + (16 + 9*c**2)*dx**4)*ud[1]**2)*UValJet[2] + u[0]*ud[1]*((c**4*dt**2*(30*(-1 + c**2)**3 + a**2*(15 + 48*c**2 - 20*c**4 + 27*c**6)*dt**2) - 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 11*c**2)*dt**2)*dx**2 + a**2*(46 + 27*c**2 - 3*c**4)*dx**4 - (-1 + c**2)*(c**6*(29 + 46*c**2)*dt**4 - 150*c**4*dt**2*dx**2 
	+ (46 + 29*c**2)*dx**4)*UValJet[0])*UValJet[2] - 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(ud[0]**2 + 2*ud[1]**2)*UValJet[3]) + 3*a*c*u[0]**2*((c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*(a**2 + UValJet[0])*UValJet[2] + 2*(-1 + c**2)*((c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2 
	+ (c**4*(3 + c**2 - 9*c**4)*dt**4 + 10*c**2*(-1 + 2*c**2)*dt**2*dx**2 - (2 + 3*c**2)*dx**4)*ud[1]**2)*UValJet[3]) - 2*(-1 + c**2)*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[0]**3*ud[1]*(3*(a**2 + UValJet[0])*UValJet[3] + 2*(-1 + c**2)*ud[0]**2*UValJet[4]))) + 2*(-1 + c**2)**2*u[1]**5*(2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*(a**2 + UValJet[0])*UValJet[1]**2 + 20*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 
	+ (2 + c**2)*dx**4)*ud[1]**2*UValJet[1]*UValJet[2] 
	+ (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(3*(a**2 + UValJet[0])**2*UValJet[2] + 4*(-1 + c**2)*ud[1]**2*(3*(a**2 + UValJet[0])*UValJet[3] + (-1 + c**2)*ud[1]**2*UValJet[4]))) + (-1 + c**2)*u[1]**3*(4*(-1 + c**2)*(2*a*c**3*(-1 + c**2)*dt**2*(c**2*(3 + 7*c**2)*dt**2 - 10*dx**2)*u[0]*ud[1] + (-1 + c**2)*((c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*ud[0]**2 
	+ 15*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[1]**2) + 2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*u[0]**2*(a**2 + UValJet[0]))*UValJet[1]**2 + UValJet[1]*(a**2*(c**4*dt**2*(-60*(-1 + c**2)**3 + a**2*(-35 - 111*c**2 + 46*c**4)*dt**2) + 5*(12*(-1 + c**2)**3 + a**2*(1 + 15*c**2 + 33*c**4 - 9*c**6)*dt**2)*dx**2 + a**2*(-43 - 63*c**2 + 6*c**4)*dx**4) + 2*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 74*c**2 + 20*c**4 + 19*c**6)*dt**2) 
	+ 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 28*c**2 - 17*c**4)*dt**2)*dx**2 
	+ a**2*(-43 - 21*c**2 + 14*c**4)*dx**4)*UValJet[0] + (-1 + c**2)*(c**6*(22 + 43*c**2)*dt**4 - 130*c**4*dt**2*dx**2 + (43 + 22*c**2)*dx**4)*UValJet[0]**2 + 40*(-1 + c**2)**2*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*u[0]**2*(ud[0]**2 + ud[1]**2)*UValJet[2]) + 4*(-1 + c**2)*(ud[1]**2*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 78*c**2 - 4*c**4 + 27*c**6)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 - 23*c**2 + 12*c**4)*dt**2)*dx**2 
	+ a**2*(-64 - 27*c**2 + 21*c**4)*dx**4 + (-1 + c**2)*(c**6*(41 + 64*c**2)*dt**4 - 210*c**4*dt**2*dx**2 + (64 + 41*c**2)*dx**4)*UValJet[0])*UValJet[2] + 10*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**4*UValJet[3] + 3*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2*((a**2*(-1 + 3*c**2) + (-1 + c**2)*UValJet[0])*UValJet[2] + 2*(-1 + c**2)**2*ud[1]**2*UValJet[3]) + 2*a*(-1 + c)*c*(1 + c)*u[0]*ud[1]*(3*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*(a**2 + UValJet[0])*UValJet[2] + 2*(-6*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**2 
	+ (c**4*(-3 + c**2 + 12*c**4)*dt**4 + 10*c**2*(1 - 3*c**2)*dt**2*dx**2 + 5*(1 + c**2)*dx**4)*ud[1]**2)*UValJet[3]) + 3*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[0]**2*((a**2 + UValJet[0])**2*UValJet[2] + 2*(-1 + c**2)*((ud[0]**2 + ud[1]**2)*(a**2 + UValJet[0])*UValJet[3] + 2*(-1 + c**2)*ud[0]**2*ud[1]**2*UValJet[4])))) + u[1]*(a**2*(360 - 2160*c**10 + 360*c**12 + 90*c**8*(60 + a**2*(dt - dx)*(dt + dx)) 
	+ a**2*(dt - dx)*(dt + dx)*(-30 + a**2*(dt**2 - 4*dx**2)) + 3*c**2*(-720 + a**4*(8*dt**4 - 25*dt**2*dx**2 + 17*dx**4)) + 15*c**4*(360 + a**2*(dt - dx)*(dt + dx)*(12 + a**2*(5*dt**2 - 4*dx**2))) + 5*c**6*(-1440 + a**2*(dt - dx)*(dt + dx)*(-48 + a**2*(4*dt**2 - dx**2)))) 
	+ (-1 + c**2)**2*(c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[0]**3 + (-1 + c**2)*UValJet[0]**2*(c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 67*c**2 + 12*c**4)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 16*c**2 + 3*c**4)*dt**2)*dx**2 
	- a**2*(12 + 49*c**2 + 9*c**4)*dx**4 + (-1 + c**2)*u[0]**2*((c**6*(22 + 43*c**2)*dt**4 - 130*c**4*dt**2*dx**2 + (43 + 22*c**2)*dx**4)*UValJet[1] + 6*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*u[0]**2*UValJet[2])) + UValJet[0]*(360 + c**2*(360*(-2 + c**2)*(3 - 3*c**2 + c**4)*(1 - c**2 + c**4) - 60*a**2*(-3 + c**2)*(-1 + c**2)**3*dt**2 + a**4*(15 + 130*c**2 + 11*c**4 - 36*c**6)*dt**4) + 5*a**2*(-12*(-1 + c**2)**3*(1 + c**2) 
	+ a**2*(-1 - 22*c**2 - 38*c**4 + 10*c**6 + 3*c**8)*dt**2)*dx**2 + a**4*(12 + 95*c**2 + 18*c**4 - 5*c**6)*dx**4 + 2*(-1 + c**2)*(4*a*c*(-1 + c**2)*(c**4*(-12 - 17*c**2 + 19*c**4)*dt**4 - 20*c**2*(-2 + c**2)*dt**2*dx**2 - (9 + c**2)*dx**4)*u[0]*ud[1]*UValJet[1] + (-1 + c**2)**2*(c**6*(11 + 19*c**2)*dt**4 
	- 60*c**4*dt**2*dx**2 + (19 + 11*c**2)*dx**4)*(ud[0]**2 + 3*ud[1]**2)*UValJet[1] 
	+ 12*a*c*(-1 + c**2)**2*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*u[0]**3*ud[1]*UValJet[2] + u[0]**2*((c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 74*c**2 + 20*c**4 + 19*c**6)*dt**2) + 5*(6*(-1 + c**2)**3 + a**2*c**2*(9 + 28*c**2 - 17*c**4)*dt**2)*dx**2 + a**2*(-43 - 21*c**2 + 14*c**4)*dx**4)*UValJet[1] + 2*(-1 + c**2)**2*((c**6*(29 + 46*c**2)*dt**4 - 150*c**4*dt**2*dx**2 + (46 + 29*c**2)*dx**4)*ud[0]**2 + 9*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2)*UValJet[2]) + 2*(-1 + c**2)*u[0]**4*((c**6*(1 + 4*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[1]**2 + 3*(c**6*(2 + 3*c**2)*dt**4 
	- 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(a**2*UValJet[2] + 2*(-1 + c**2)*ud[0]**2*UValJet[3])))) + (-1 + c)*(1 + c)*(8*a*c*(-1 + c**2)*u[0]*ud[1]*(-((c**2*dt**2*(30*(-1 + c**2)**3 + a**2*(5 + 27*c**2 - 2*c**4)*dt**2) - 40*a**2*c**2*dt**2*dx**2 + a**2*(9 + c**2)*dx**4)*UValJet[1]) + 3*(-1 + c**2)*(-3*(c*dt - dx)*(c*dt + dx)*(c**2*(3 + 7*c**2)*dt**2 - (7 + 3*c**2)*dx**2)*ud[0]**2 + (c**4*(-3 + c**2 + 12*c**4)*dt**4 + 10*c**2*(1 - 3*c**2)*dt**2*dx**2 
	+ 5*(1 + c**2)*dx**4)*ud[1]**2)*UValJet[2]) 
	+ 2*(-1 + c)*(1 + c)*(-3*(5*c**4*dt**2*(6*(-1 + c**2)**3 + a**2*(3 + 12*c**2 + c**4)*dt**2) - 10*(3*(-1 + c**2)**3 + a**2*c**2*(3 + 12*c**2 + c**4)*dt**2)*dx**2 + a**2*(19 + 52*c**2 + 9*c**4)*dx**4)*ud[1]**2*UValJet[1] + 3*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**4*UValJet[2] + 15*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**4*UValJet[2] 
	+ ud[0]**2*((c**4*dt**2*(-30*(-1 + c**2)**3 + a**2*(-15 - 12*c**2 + 107*c**4)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 + 4*c**2 + 15*c**4)*dt**2)*dx**2 
	+ a**2*(-19 + 60*c**2 + 39*c**4)*dx**4)*UValJet[1] + 18*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[2])) + 8*a*c*(-1 + c**2)**2*u[0]**3*ud[1]*((c**4*(3 + 7*c**2)*dt**4 - 10*c**2*dt**2*dx**2)*UValJet[1]**2 
	+ 3*(3*c**4*(1 + 2*c**2)*dt**4 - 10*c**2*dt**2*dx**2 + dx**4)*(a**2*UValJet[2] + 2*(-1 + c**2)*ud[0]**2*UValJet[3])) + u[0]**2*(a**2*(c**4*dt**2*(-60*(-1 + c**2)**3 + a**2*(-35 - 111*c**2 + 46*c**4)*dt**2) + 5*(12*(-1 + c**2)**3 + a**2*(1 + 15*c**2 + 33*c**4 - 9*c**6)*dt**2)*dx**2 + a**2*(-43 - 63*c**2 + 6*c**4)*dx**4)*UValJet[1] + 4*(-1 + c**2)**2*((c**6*(11 + 24*c**2)*dt**4 - 70*c**4*dt**2*dx**2 + (24 + 11*c**2)*dx**4)*ud[0]**2 + 5*(c**6*(1 + 2*c**2)*dt**4 
	- 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[1]**2)*UValJet[1]**2 + 4*(-1 + c**2)*(3*a**2*(c**6*(-18 - 19*c**2 + 27*c**4)*dt**4 + 10*c**4*(7 - 5*c**2)*dt**2*dx**2 + (-9 - 7*c**2 + 6*c**4)*dx**4)*ud[1]**2*UValJet[2] + 6*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[0]**4*UValJet[3] + ud[0]**2*((c**4*dt**2*(-30*(-1 + c**2)**3 - a**2*(15 + 30*c**2 - 62*c**4 + 27*c**6)*dt**2) - 10*(-3*(-1 + c**2)**3 + a**2*c**2*(-3 - 5*c**2 + 6*c**4)*dt**2)*dx**2 
	+ a**2*(-46 + 15*c**2 + 21*c**4)*dx**4)*UValJet[2] + 18*(-1 + c**2)**2*(c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*ud[1]**2*UValJet[3]))) 
	+ 2*(-1 + c**2)*u[0]**4*(2*a**2*(c**6*(1 + 4*c**2)*dt**4 
	- 10*c**4*dt**2*dx**2 + (4 + c**2)*dx**4)*UValJet[1]**2 + 20*(-1 + c**2)*(c**6*(1 + 2*c**2)*dt**4 - 6*c**4*dt**2*dx**2 + (2 + c**2)*dx**4)*ud[0]**2*UValJet[1]*UValJet[2] + (c**6*(2 + 3*c**2)*dt**4 - 10*c**4*dt**2*dx**2 + (3 + 2*c**2)*dx**4)*(3*a**4*UValJet[2] + 4*(-1 + c**2)*ud[0]**2*(3*a**2*UValJet[3] + (-1 + c**2)*ud[0]**2*UValJet[4]))))))/(360.*(-1 + c**2)**7)
	])
	
	
	return jnp.concatenate([ud,rhs])


def Hmod(phi,VdJet,a,c,dt,dx,ds):

	#dphi = (phi[2:]-phi[:-2])/(2*ds)
	dphi = (-phi[4:]+8*phi[3:-1]-8*phi[1:-3]+phi[:-4])/(12*ds) # fourth oder finite differences
	dnrm2 = jnp.sum(dphi**2,1)
	nrm2 = jnp.sum(phi[2:-2]**2,1)


	J = jnp.array([[0,1],[-1,0]])

	phidJphi = dphi[:,0]*phi[2:-2,1]-dphi[:,1]*phi[2:-2,0]
	phidphi = dphi[:,0]*phi[2:-2,0]+dphi[:,1]*phi[2:-2,1]
	V1 = VdJet[1](nrm2)
	V2 = VdJet[2](nrm2)
	V3 = VdJet[3](nrm2)
	V4 = VdJet[4](nrm2)

	H0 = 1/2*(-a**2*nrm2+(c**2-1)*dnrm2-VdJet[0](nrm2))

	# 2nd order modification
	d1=1/(24*(c**2-1)**2)*(2*a**2*V1*(dx**2-c**4*dt**2)+V1**2*(dx**2-c**4*dt**2)+a**4*((1-2*c**2)*dt**2+dx**2))
	d2 = 1/(12*(c**2-1)**2)*(a**2*(-3*c**4*dt**2+c**2*(5*dx**2-3*dt**2)+dx**2)+(c**2-1)*V1*(c**4*dt**2-dx**2))
	d3 = a*c*(c**2*dt**2-dx**2)*(a**2+V1)/(3*(c**2-1)**2)
	d4 = V2*(c**4*dt**2-dx**2)/(6*(c**2-1))

	Hdiff2 = d1*nrm2+d2*dnrm2+d3*phidJphi+d4*phidphi**2

	H2 = H0 + Hdiff2

	# 4th order modification
	
	phi1 = phi[2:-2,0]
	phi2 = phi[2:-2,1]
	
	dphi1 = dphi[:,0]
	dphi2 = dphi[:,1]

	Hdiff4 = -0.001388888888888889*(4*a**5*c*(-15*dt**2*dx**2 + 9*dx**4 + 2*c**6*(2*dt**4 - 5*dt**2*dx**2) + 3*c**2*(5*dt**4 - 10*dt**2*dx**2 + 7*dx**4) + c**4*(21*dt**4 - 25*dt**2*dx**2 + 10*dx**4))*(dphi2*phi1 - dphi1*phi2) + a**6*((-1 + 5*c**2 + 10*c**4 + 6*c**6)*dt**4 - 5*(1 + 3*c**2 + c**4 + 3*c**6)*dt**2*dx**2 + (3 + 7*c**2 + 10*c**4)*dx**4)*(phi1**2 + phi2**2) - 
	8*a**3*c*(c**2*dt**2 - dx**2)*(dphi2*phi1 - dphi1*phi2)*(dx**2*((9 + 9*c**2 + 2*c**4)*V1 - (-7 + 4*c**2 + 3*c**4)*(phi1**2 + phi2**2)*V2) + dt**2*((-5 - 21*c**2 + 4*c**4 + 2*c**6)*V1 + c**2*(-3 - 4*c**2 + 7*c**4)*(phi1**2 + phi2**2)*V2)) - 
	a**4*(6*c**10*dt**4*(phi1**2 + phi2**2)**2*V2 + c**8*dt**2*(-5*dphi1**2*(2*dt**2 - 5*dx**2) - 5*dphi2**2*(2*dt**2 - 5*dx**2) - 2*dt**2*(phi1**2 + phi2**2)*(-2*V1 + (phi1**2 + phi2**2)*V2)) + c**2*(dphi1**2*(-15*dt**4 + 130*dt**2*dx**2 - 91*dx**4) + dphi2**2*(-15*dt**4 + 130*dt**2*dx**2 - 91*dx**4) + dx**2*(phi1**2 + phi2**2)*(45*dt**2*V1 + dx**2*(-13*V1 + 2*(phi1**2 + phi2**2)*V2))) - 
	dx**2*(dphi1**2*(-5*dt**2 + 2*dx**2) + dphi2**2*(-5*dt**2 + 2*dx**2) + (phi1**2 + phi2**2)*(-5*dt**2*V1 + 3*dx**2*(3*V1 + 2*(phi1**2 + phi2**2)*V2))) + 
	c**4*(-2*dphi1**2*(60*dt**4 - 95*dt**2*dx**2 + 56*dx**4) - 2*dphi2**2*(60*dt**4 - 95*dt**2*dx**2 + 56*dx**4) + (phi1**2 + phi2**2)*(-35*dt**4*V1 + 2*dx**4*(-9*V1 + 2*(phi1**2 + phi2**2)*V2) + 5*dt**2*dx**2*(V1 + 4*(phi1**2 + phi2**2)*V2))) - 
	c**6*(5*dphi1**2*(19*dt**4 - 26*dt**2*dx**2 + 7*dx**4) + 5*dphi2**2*(19*dt**4 - 26*dt**2*dx**2 + 7*dx**4) + dt**2*(phi1**2 + phi2**2)*(5*dx**2*(-5*V1 + 4*(phi1**2 + phi2**2)*V2) + dt**2*(9*V1 + 4*(phi1**2 + phi2**2)*V2)))) + 
	4*a*c*(-1 + c**2)*(dphi2*phi1 - dphi1*phi2)*(-18*c**8*dt**4*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) + 12*c**10*dt**4*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) + 
	dx**4*(-9*V1**2 - 14*(phi1**2 + phi2**2)*V1*V2 + 8*dphi1*dphi2*phi1*phi2*V3 + 2*dphi1**2*(V2 + 2*phi1**2*V3) + 2*dphi2**2*(V2 + 2*phi2**2*V3)) - c**6*dt**2*(dt**2*V1*(9*V1 + 14*(phi1**2 + phi2**2)*V2) + 20*dx**2*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3))) - 
	c**2*dx**2*(2*dx**2*(3*V1**2 + 3*(phi1**2 + phi2**2)*V1*V2 + 8*dphi1*dphi2*phi1*phi2*V3 + 2*dphi1**2*(V2 + 2*phi1**2*V3) + 2*dphi2**2*(V2 + 2*phi2**2*V3)) - 5*dt**2*(3*V1**2 + 4*(phi1**2 + phi2**2)*V1*V2 - 4*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)))) + 
	c**4*(-6*dt**4*(V1**2 + (phi1**2 + phi2**2)*V1*V2 - 4*dphi1*dphi2*phi1*phi2*V3 - dphi1**2*(V2 + 2*phi1**2*V3) - dphi2**2*(V2 + 2*phi2**2*V3)) + 2*dx**4*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) + 
	5*dt**2*dx**2*(3*V1**2 + 4*(phi1**2 + phi2**2)*V1*V2 + 8*(4*dphi1*dphi2*phi1*phi2*V3 + dphi1**2*(V2 + 2*phi1**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3))))) + 
	a**2*(12*c**12*dt**4*(4*dphi1*dphi2*phi1*phi2*(-V2 + (phi1**2 + phi2**2)*V3) + dphi1**2*(3*phi2**2*V2 + 2*phi1**4*V3 + phi1**2*(V2 + 2*phi2**2*V3)) + dphi2**2*(phi2**2*(V2 + 2*phi2**2*V3) + phi1**2*(3*V2 + 2*phi2**2*V3))) + 
	dx**4*(3*(phi1**2 + phi2**2)*V1*(3*V1 + 4*(phi1**2 + phi2**2)*V2) + 16*dphi1*dphi2*phi1*phi2*(4*V2 + 3*(phi1**2 + phi2**2)*V3) + 4*dphi2**2*(V1 + 11*phi2**2*V2 + 6*phi2**4*V3 + 3*phi1**2*(V2 + 2*phi2**2*V3)) + 4*dphi1**2*(V1 + 3*phi2**2*V2 + 6*phi1**4*V3 + phi1**2*(11*V2 + 6*phi2**2*V3))) - 
	2*c**10*dt**4*((phi1**2 + phi2**2)*V1*(V1 + 6*(phi1**2 + phi2**2)*V2) + 8*dphi1*dphi2*phi1*phi2*(-23*V2 + 4*(phi1**2 + phi2**2)*V3) + 2*dphi1**2*(3*V1 + 34*phi2**2*V2 + 8*phi1**4*V3 + phi1**2*(-12*V2 + 8*phi2**2*V3)) + 2*dphi2**2*(3*V1 - 12*phi2**2*V2 + 8*phi2**4*V3 + phi1**2*(34*V2 + 8*phi2**2*V3))) - 
	c**2*dx**2*((phi1**2 + phi2**2)*V1*(30*dt**2*V1 + dx**2*(-5*V1 + 4*(phi1**2 + phi2**2)*V2)) + 8*dphi1*dphi2*phi1*phi2*(15*dt**2*V2 + dx**2*(7*V2 + 8*(phi1**2 + phi2**2)*V3)) + dphi1**2*(30*dt**2*(V1 + 2*phi1**2*V2) - 2*dx**2*(45*V1 + 36*phi2**2*V2 - 16*phi1**4*V3 + 2*phi1**2*(11*V2 - 8*phi2**2*V3))) + 
	dphi2**2*(30*dt**2*(V1 + 2*phi2**2*V2) - 2*dx**2*(45*V1 + 22*phi2**2*V2 - 16*phi2**4*V3 + 4*phi1**2*(9*V2 - 4*phi2**2*V3)))) - 2*c**8*dt**2*(-2*dt**2*(phi1**2 + phi2**2)*V1*(-2*V1 + (phi1**2 + phi2**2)*V2) + 4*dphi1*dphi2*phi1*phi2*(dt**2*(69*V2 + 2*(phi1**2 + phi2**2)*V3) + 5*dx**2*(7*V2 + 4*(phi1**2 + phi2**2)*V3)) + 
	dphi2**2*(5*dx**2*(-5*V1 + 10*phi2**2*V2 + 8*phi2**4*V3 - 4*phi1**2*(V2 - 2*phi2**2*V3)) + dt**2*(43*V1 + 4*phi2**2*(29*V2 + phi2**2*V3) + phi1**2*(-22*V2 + 4*phi2**2*V3))) + dphi1**2*(dt**2*(43*V1 - 22*phi2**2*V2 + 4*phi1**4*V3 + 4*phi1**2*(29*V2 + phi2**2*V3)) + 5*dx**2*(-5*V1 - 4*phi2**2*V2 + 8*phi1**4*V3 + 2*phi1**2*(5*V2 + 4*phi2**2*V3)))) + 
	c**4*(-((phi1**2 + phi2**2)*V1*(-15*dt**4*V1 + 2*dx**4*(-3*V1 + 4*(phi1**2 + phi2**2)*V2) + 10*dt**2*dx**2*(V1 + 4*(phi1**2 + phi2**2)*V2))) - 8*dphi1*dphi2*phi1*phi2*(-15*dt**4*V2 + 2*dx**4*(phi1**2 + phi2**2)*V3 + 5*dt**2*dx**2*(5*V2 + 4*(phi1**2 + phi2**2)*V3)) + 
	2*dphi2**2*(15*dt**4*(V1 + 2*phi2**2*V2) - 5*dt**2*dx**2*(17*V1 + 30*phi2**2*V2 + 8*phi2**4*V3 + 4*phi1**2*(5*V2 + 2*phi2**2*V3)) - 2*dx**4*(13*V1 + (phi1**2 + phi2**2)*(15*V2 + 2*phi2**2*V3))) + 
	2*dphi1**2*(15*dt**4*(V1 + 2*phi1**2*V2) - 2*dx**4*(13*V1 + (phi1**2 + phi2**2)*(15*V2 + 2*phi1**2*V3)) - 5*dt**2*dx**2*(17*V1 + 20*phi2**2*V2 + 8*phi1**4*V3 + phi1**2*(30*V2 + 8*phi2**2*V3)))) + 
	c**6*(dt**2*(phi1**2 + phi2**2)*V1*(40*dx**2*(phi1**2 + phi2**2)*V2 + dt**2*(15*V1 + 8*(phi1**2 + phi2**2)*V2)) + 8*dphi1*dphi2*phi1*phi2*(2*dt**4*(7*V2 + 2*(phi1**2 + phi2**2)*V3) + dx**4*(-V2 + 4*(phi1**2 + phi2**2)*V3) + 5*dt**2*dx**2*(15*V2 + 8*(phi1**2 + phi2**2)*V3)) + 
	2*dphi2**2*(5*dt**2*dx**2*(15*V1 + 46*phi2**2*V2 + 16*phi2**4*V3 + 16*phi1**2*(V2 + phi2**2*V3)) + dt**4*(34*V1 + 8*phi2**2*(7*V2 + phi2**2*V3) + 4*phi1**2*(7*V2 + 2*phi2**2*V3)) + dx**4*(-21*V1 - 14*phi2**2*V2 + 8*phi2**4*V3 + 2*phi1**2*(-6*V2 + 4*phi2**2*V3))) + 
	2*dphi1**2*(dt**4*(34*V1 + 28*phi2**2*V2 + 8*phi1**4*V3 + 8*phi1**2*(7*V2 + phi2**2*V3)) + dx**4*(-21*V1 - 12*phi2**2*V2 + 8*phi1**4*V3 + 2*phi1**2*(-7*V2 + 4*phi2**2*V3)) + 5*dt**2*dx**2*(15*V1 + 2*(8*phi2**2*V2 + 8*phi1**4*V3 + phi1**2*(23*V2 + 8*phi2**2*V3)))))) + 
	(-1 + c**2)*(6*c**12*dt**4*(8*dphi1**3*dphi2*phi1*phi2*(3*V3 + 2*phi1**2*V4) + dphi1**4*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 8*dphi1*dphi2**3*phi1*phi2*(3*V3 + 2*phi2**2*V4) + dphi2**4*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) + 6*dphi1**2*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))) + 
	dx**4*(-3*(phi1**2 + phi2**2)*V1**2*(V1 + 2*(phi1**2 + phi2**2)*V2) - 2*dphi2**2*(V1**2 + 4*phi2**2*(phi1**2 + phi2**2)*V2**2 + 2*V1*(11*phi2**2*V2 + 6*phi2**4*V3 + 3*phi1**2*(V2 + 2*phi2**2*V3))) + 48*dphi1**3*dphi2*phi1*phi2*(3*V3 + 2*phi1**2*V4) + 6*dphi1**4*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 
	16*dphi1*dphi2*phi1*phi2*(-4*V1*V2 - phi1**2*V2**2 - phi2**2*V2**2 + 9*dphi2**2*V3 - 3*(phi1**2 + phi2**2)*V1*V3 + 6*dphi2**2*phi2**2*V4) + 6*dphi2**4*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) - 2*dphi1**2*(V1**2 + 4*phi1**2*(phi1**2 + phi2**2)*V2**2 + 2*V1*(3*phi2**2*V2 + 6*phi1**4*V3 + phi1**2*(11*V2 + 6*phi2**2*V3)) - 18*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4)))
	) - c**2*dx**4*(2*(phi1**2 + phi2**2)*V1**2*(V1 + 2*(phi1**2 + phi2**2)*V2) + dphi2**2*(V1**2 + 4*phi2**2*(phi1**2 + phi2**2)*V2**2 - 4*V1*(2*phi2**2*(V2 + phi2**2*V3) + phi1**2*(V2 + 2*phi2**2*V3))) + 64*dphi1**3*dphi2*phi1*phi2*(3*V3 + 2*phi1**2*V4) + 8*dphi1**4*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 
	8*dphi1*dphi2*phi1*phi2*(phi1**2*V2**2 + phi2**2*V2**2 + 24*dphi2**2*V3 - V1*(V2 + 2*(phi1**2 + phi2**2)*V3) + 16*dphi2**2*phi2**2*V4) + 8*dphi2**4*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) + dphi1**2*(V1**2 + 4*phi1**2*(phi1**2 + phi2**2)*V2**2 - 4*V1*(phi2**2*V2 + 2*phi1**4*V3 + 2*phi1**2*(V2 + phi2**2*V3)) + 48*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4)))) + 
	c**6*(-2*dt**4*(phi1**2 + phi2**2)*V1**2*(V1 + 2*(phi1**2 + phi2**2)*V2) - dphi2**2*dt**2*(10*dx**2*(V1**2 + 4*phi2**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(4*phi2**2*V2 + 2*phi2**4*V3 + phi1**2*(V2 + 2*phi2**2*V3))) + dt**2*(3*V1**2 + 12*phi2**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(9*phi2**2*V2 + 4*phi2**4*V3 + 2*phi1**2*(V2 + 2*phi2**2*V3)))) + 
	32*dphi1**3*dphi2*(dt**4 + 10*dt**2*dx**2 + dx**4)*phi1*phi2*(3*V3 + 2*phi1**2*V4) + 4*dphi1**4*(dt**4 + 10*dt**2*dx**2 + dx**4)*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 4*dphi2**4*(dt**4 + 10*dt**2*dx**2 + dx**4)*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) + 
	8*dphi1*dphi2*phi1*phi2*(4*dphi2**2*dx**4*(3*V3 + 2*phi2**2*V4) - 10*dt**2*dx**2*(3*V1*V2 + phi1**2*V2**2 + phi2**2*V2**2 - 12*dphi2**2*V3 + 2*(phi1**2 + phi2**2)*V1*V3 - 8*dphi2**2*phi2**2*V4) - dt**4*(7*V1*V2 + 3*phi1**2*V2**2 + 3*phi2**2*V2**2 - 12*dphi2**2*V3 + 4*(phi1**2 + phi2**2)*V1*V3 - 8*dphi2**2*phi2**2*V4)) - 
	dphi1**2*(-24*dphi2**2*dx**4*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4)) + 10*dt**2*dx**2*(V1**2 + 4*phi2**2*V1*V2 + 4*phi1**2*(phi1**2 + phi2**2)*V2**2 + 8*phi1**4*V1*V3 + 8*phi1**2*V1*(2*V2 + phi2**2*V3) - 24*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))) + 
	dt**4*(3*V1**2 + 12*phi1**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(2*phi2**2*V2 + 4*phi1**4*V3 + phi1**2*(9*V2 + 4*phi2**2*V3)) - 24*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))))) + 
	c**4*dx**2*(10*dt**2*(phi1**2 + phi2**2)*V1**2*(V1 + 2*(phi1**2 + phi2**2)*V2) + dphi2**2*(10*dt**2*(V1**2 + 4*phi2**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(4*phi2**2*V2 + 2*phi2**4*V3 + phi1**2*(V2 + 2*phi2**2*V3))) + dx**2*(3*V1**2 + 12*phi2**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(9*phi2**2*V2 + 4*phi2**4*V3 + 2*phi1**2*(V2 + 2*phi2**2*V3)))) - 
	16*dphi1**3*dphi2*(10*dt**2 + dx**2)*phi1*phi2*(3*V3 + 2*phi1**2*V4) - 2*dphi1**4*(10*dt**2 + dx**2)*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) - 2*dphi2**4*(10*dt**2 + dx**2)*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) + 
	8*dphi1*dphi2*phi1*phi2*(10*dt**2*(3*V1*V2 + phi1**2*V2**2 + phi2**2*V2**2 - 6*dphi2**2*V3 + 2*(phi1**2 + phi2**2)*V1*V3 - 4*dphi2**2*phi2**2*V4) + dx**2*(7*V1*V2 + 3*phi1**2*V2**2 + 3*phi2**2*V2**2 - 6*dphi2**2*V3 + 4*(phi1**2 + phi2**2)*V1*V3 - 4*dphi2**2*phi2**2*V4)) + 
	dphi1**2*(10*dt**2*(V1**2 + 4*phi1**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(phi2**2*V2 + 2*phi1**4*V3 + 2*phi1**2*(2*V2 + phi2**2*V3)) - 12*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))) + 
	dx**2*(3*V1**2 + 12*phi1**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(2*phi2**2*V2 + 4*phi1**4*V3 + phi1**2*(9*V2 + 4*phi2**2*V3)) - 12*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))))) - 
	2*c**10*dt**4*(32*dphi1**3*dphi2*phi1*phi2*(3*V3 + 2*phi1**2*V4) + 4*dphi1**4*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 8*dphi1*dphi2*phi1*phi2*(-4*V1*V2 - phi1**2*V2**2 - phi2**2*V2**2 + 12*dphi2**2*V3 - 3*(phi1**2 + phi2**2)*V1*V3 + 8*dphi2**2*phi2**2*V4) + 
	dphi2**2*(-V1**2 - 4*phi2**2*(phi1**2 + phi2**2)*V2**2 - 2*V1*(11*phi2**2*V2 + 6*phi2**4*V3 + 3*phi1**2*(V2 + 2*phi2**2*V3)) + 4*dphi2**2*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4)) - dphi1**2*(V1**2 + 2*V1*(3*phi2**2*V2 + 6*phi1**4*V3 + phi1**2*(11*V2 + 6*phi2**2*V3)) + 4*(phi1**2*(phi1**2 + phi2**2)*V2**2 - 6*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4))))) - 
	c**8*dt**2*(3*dt**2*(phi1**2 + phi2**2)*V1**2*(V1 + 2*(phi1**2 + phi2**2)*V2) + dphi2**2*dt**2*(-V1**2 - 4*phi2**2*(phi1**2 + phi2**2)*V2**2 + 8*phi2**2*V1*(V2 + phi2**2*V3) + 4*phi1**2*V1*(V2 + 2*phi2**2*V3)) + 16*dphi1**3*dphi2*(dt**2 + 10*dx**2)*phi1*phi2*(3*V3 + 2*phi1**2*V4) + 2*dphi1**4*(dt**2 + 10*dx**2)*(3*V2 + 12*phi1**2*V3 + 4*phi1**4*V4) + 
	2*dphi2**4*(dt**2 + 10*dx**2)*(3*V2 + 12*phi2**2*V3 + 4*phi2**4*V4) + 8*dphi1*dphi2*phi1*phi2*(20*dphi2**2*dx**2*(3*V3 + 2*phi2**2*V4) + dt**2*(-(phi1**2*V2**2) - phi2**2*V2**2 + 6*dphi2**2*V3 + V1*(V2 + 2*(phi1**2 + phi2**2)*V3) + 4*dphi2**2*phi2**2*V4)) + 
	dphi1**2*(120*dphi2**2*dx**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4)) + dt**2*(-V1**2 - 4*phi1**2*(phi1**2 + phi2**2)*V2**2 + 4*V1*(phi2**2*V2 + 2*phi1**4*V3 + 2*phi1**2*(V2 + phi2**2*V3)) + 12*dphi2**2*(V2 + 2*phi2**2*V3 + 2*phi1**2*(V3 + 2*phi2**2*V4)))))))/(-1 + c**2)**5
      
	H4 = H2 + Hdiff4
	
	
	# modified angular momentum
	
	I0 = a*c*nrm2+(c**2-1)*(-phidJphi)

	b1 = a*c*(a**2*(dx**2-dt**2)+V1*(c**2*(c**2-2)*dt**2+dx**2))
	b2 = a*c*(c**2-1)*(c**2*dt**2-dx**2)
	b3 = a**2*(c**4*dt**2+c**2*(dx**2-3*dt**2)+dx**2)+(c**2-1)*V1*(c**4*dt**2-dx**2)

	Idiff = 1/(6*(c**2-1)**2)*(b1*nrm2+b2*dnrm2-b3*phidJphi)

	I2 = I0+Idiff
	
	I4diff=(-2*a*c*(-1 + c**2)*(dphi1**2 + dphi2**2)*(c**2*dt**2 - dx**2)*(a**2*(-((5 + 3*c**2 + 2*c**4)*dt**2) + (2 + 3*c**2 + 5*c**4)*dx**2) + (-1 + c**2)*(2*c**4*dt**2 - 2*dx**2 + 3*c**2*(dt**2 - dx**2))*V1) + 
	dphi1*phi2*(a**4*(-5*dt**2*dx**2 + 2*dx**4 + c**8*(-6*dt**4 + 15*dt**2*dx**2) + c**6*(31*dt**4 - 50*dt**2*dx**2 - 5*dx**4) + 5*c**2*(3*dt**4 - 10*dt**2*dx**2 + 7*dx**4) + c**4*(40*dt**4 - 70*dt**2*dx**2 + 48*dx**4)) + 2*a**2*(-1 + c**2)*(2*c**8*dt**4 - 2*dx**4 + c**6*(-17*dt**4 + 5*dt**2*dx**2) + c**2*(15*dt**2*dx**2 - 19*dx**4) + c**4*(-15*dt**4 + 40*dt**2*dx**2 - 9*dx**4))*V1 + 
	(-1 + c**2)**2*(12*c**10*(dphi1**2 + dphi2**2)*dt**4*V2 + 2*dx**4*(V1**2 - 6*(dphi1**2 + dphi2**2)*V2) + 2*c**8*dt**4*(V1**2 - 2*(dphi1**2 + dphi2**2)*V2) + c**2*dx**4*(3*V1**2 + 4*(dphi1**2 + dphi2**2)*V2) + c**6*(-40*(dphi1**2 + dphi2**2)*dt**2*dx**2*V2 + dt**4*(3*V1**2 - 8*(dphi1**2 + dphi2**2)*V2)) + 
	c**4*(8*(dphi1**2 + dphi2**2)*dx**4*V2 - 10*dt**2*dx**2*(V1**2 - 4*(dphi1**2 + dphi2**2)*V2)))) + a*c*phi2**2*(a**4*((-3 - 15*c**2 - 24*c**4 + 2*c**6)*dt**4 - 5*(-3 - 7*c**2 - 7*c**4 + c**6)*dt**2*dx**2 - (9 + 29*c**2 + 2*c**4)*dx**4) + 
	2*a**2*(5*dt**2*dx**2 - 9*dx**4 + c**6*(9*dt**4 - 5*dt**2*dx**2) + c**2*(-10*dt**4 + 35*dt**2*dx**2 - 13*dx**4) + c**4*(-19*dt**4 + 5*dt**2*dx**2 + 2*dx**4))*V1 - 
	(-1 + c**2)*(12*c**10*(3*dphi1**2 + dphi2**2)*dt**4*V2 + dx**4*(-9*V1**2 - 8*(dphi1**2 - 8*dphi2**2)*V2) + 2*c**8*dt**4*(V1**2 - 20*(dphi1**2 + 2*dphi2**2)*V2) - 4*c**6*dt**2*(5*(4*dphi1**2 - 3*dphi2**2)*dx**2*V2 + dt**2*(2*V1**2 + 2*dphi1**2*V2 - 11*dphi2**2*V2)) - 2*c**2*dx**2*(-10*dt**2*(V1**2 - 2*dphi1**2*V2 - 5*dphi2**2*V2) + dx**2*(3*V1**2 + 2*dphi1**2*V2 + 24*dphi2**2*V2)) + 
	c**4*(4*(3*dphi1**2 - 4*dphi2**2)*dx**4*V2 + 10*dt**2*dx**2*(V1**2 + 4*(3*dphi1**2 + dphi2**2)*V2) + 3*dt**4*(-3*V1**2 + 4*(dphi1**2 + 2*dphi2**2)*V2)))) - 4*a*c*(-1 + c**2)*(-3*c**4*dt**4 - 5*c**6*dt**4 + 3*c**8*dt**4 - 4*dx**4 + c**2*(10*dt**2*dx**2 - dx**4))*phi1**4*((a**2 + V1)*V2 + 2*(-1 + c**2)*dphi1**2*V3) - 
	4*a*c*(-1 + c**2)*(-3*c**4*dt**4 - 5*c**6*dt**4 + 3*c**8*dt**4 - 4*dx**4 + c**2*(10*dt**2*dx**2 - dx**4))*phi2**4*((a**2 + V1)*V2 + 2*(-1 + c**2)*dphi2**2*V3) - 
	4*(-1 + c**2)*dphi2*phi1**3*(a**2*(-11*c**8*dt**4 + 9*c**10*dt**4 + 30*c**4*dt**2*dx**2 - 3*dx**4 - 7*c**2*dx**4 - 2*c**6*(4*dt**4 + 5*dt**2*dx**2))*V2 + 4*a*c*(-1 + c**2)*dphi1*(-3*c**4*dt**4 - 5*c**6*dt**4 + 3*c**8*dt**4 - 4*dx**4 + c**2*(10*dt**2*dx**2 - dx**4))*phi2*V3 + 
	(-1 + c**2)*(2*c**6*dt**4 + 3*c**8*dt**4 - 10*c**4*dt**2*dx**2 + 3*dx**4 + 2*c**2*dx**4)*(V1*V2 + 2*(-1 + c**2)*dphi1**2*V3)) + 4*(-1 + c**2)*dphi1*phi2**3*
	(a**2*(-11*c**8*dt**4 + 9*c**10*dt**4 + 30*c**4*dt**2*dx**2 - 3*dx**4 - 7*c**2*dx**4 - 2*c**6*(4*dt**4 + 5*dt**2*dx**2))*V2 + (-1 + c**2)*(2*c**6*dt**4 + 3*c**8*dt**4 - 10*c**4*dt**2*dx**2 + 3*dx**4 + 2*c**2*dx**4)*(V1*V2 + 2*(-1 + c**2)*dphi2**2*V3)) + 
	phi1**2*(-(a*c*(-1 + c**2)*(-8*c**6*dt**4 + 2*c**8*dt**4 - 9*dx**4 + c**4*(-9*dt**4 + 10*dt**2*dx**2) + c**2*(20*dt**2*dx**2 - 6*dx**4))*V1**2) + a*c*(a**4*((-3 - 15*c**2 - 24*c**4 + 2*c**6)*dt**4 - 5*(-3 - 7*c**2 - 7*c**4 + c**6)*dt**2*dx**2 - (9 + 29*c**2 + 2*c**4)*dx**4) - 
	4*(-1 + c**2)**2*dphi1**2*(-17*c**6*dt**4 + 3*c**8*dt**4 - 16*dx**4 + c**4*(-6*dt**4 + 15*dt**2*dx**2) + c**2*(25*dt**2*dx**2 - 4*dx**4))*V2 - 4*(-1 + c**2)**2*dphi2**2*(-(c**6*dt**4) + 9*c**8*dt**4 + 2*dx**4 - c**4*(3*dt**4 + 20*dt**2*dx**2) + c**2*(10*dt**2*dx**2 + 3*dx**4))*V2) + 
	2*V1*(a**3*c*(5*dt**2*dx**2 - 9*dx**4 + c**6*(9*dt**4 - 5*dt**2*dx**2) + c**2*(-10*dt**4 + 35*dt**2*dx**2 - 13*dx**4) + c**4*(-19*dt**4 + 5*dt**2*dx**2 + 2*dx**4)) + 2*(-1 + c**2)**2*dphi1*(2*c**6*dt**4 + 3*c**8*dt**4 - 10*c**4*dt**2*dx**2 + 3*dx**4 + 2*c**2*dx**4)*phi2*V2 - 
	4*a*c*(-1 + c**2)*(-3*c**4*dt**4 - 5*c**6*dt**4 + 3*c**8*dt**4 - 4*dx**4 + c**2*(10*dt**2*dx**2 - dx**4))*phi2**2*V2) - 8*a*c*(-1 + c**2)*(-3*c**4*dt**4 - 5*c**6*dt**4 + 3*c**8*dt**4 - 4*dx**4 + c**2*(10*dt**2*dx**2 - dx**4))*phi2**2*(a**2*V2 + (-1 + c**2)*(dphi1**2 + dphi2**2)*V3) + 
	4*(-1 + c**2)*dphi1*phi2*(a**2*(-11*c**8*dt**4 + 9*c**10*dt**4 + 30*c**4*dt**2*dx**2 - 3*dx**4 - 7*c**2*dx**4 - 2*c**6*(4*dt**4 + 5*dt**2*dx**2))*V2 + 2*(-1 + c**2)**2*(dphi1**2 - 2*dphi2**2)*(2*c**6*dt**4 + 3*c**8*dt**4 - 10*c**4*dt**2*dx**2 + 3*dx**4 + 2*c**2*dx**4)*V3)) + 
	dphi2*phi1*(a**4*(5*dt**2*dx**2 - 2*dx**4 + 3*c**8*(2*dt**4 - 5*dt**2*dx**2) + c**4*(-40*dt**4 + 70*dt**2*dx**2 - 48*dx**4) + c**6*(-31*dt**4 + 50*dt**2*dx**2 + 5*dx**4) - 5*c**2*(3*dt**4 - 10*dt**2*dx**2 + 7*dx**4)) - 
	2*a**2*(-1 + c**2)*(18*c**10*dt**4*phi2**2*V2 + 2*c**8*dt**4*(V1 - 11*phi2**2*V2) - 2*dx**4*(V1 + 3*phi2**2*V2) + c**4*(-15*dt**4*V1 - 9*dx**4*V1 + 20*dt**2*dx**2*(2*V1 + 3*phi2**2*V2)) + c**2*(15*dt**2*dx**2*V1 - dx**4*(19*V1 + 14*phi2**2*V2)) - c**6*(-5*dt**2*dx**2*(V1 - 4*phi2**2*V2) + dt**4*(17*V1 + 16*phi2**2*V2))) + 
	8*a*c*(-1 + c**2)**2*dphi1*phi2*(6*c**8*dt**4*(V2 - phi2**2*V3) + 2*dx**4*(9*V2 + 4*phi2**2*V3) + 2*c**6*dt**4*(8*V2 + 5*phi2**2*V3) + c**4*(-35*dt**2*dx**2*V2 + 3*dt**4*(V2 + 2*phi2**2*V3)) + c**2*(dx**4*(7*V2 + 2*phi2**2*V3) - 5*dt**2*dx**2*(3*V2 + 4*phi2**2*V3))) - 
	(-1 + c**2)**2*(12*c**10*dt**4*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) + c**2*dx**4*(3*V1**2 + 8*phi2**2*V1*V2 + 4*dphi1**2*(V2 - 4*phi2**2*V3) + 4*dphi2**2*(V2 + 2*phi2**2*V3)) + 2*dx**4*(V1**2 + 6*phi2**2*V1*V2 - 6*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3))) + 
	2*c**8*dt**4*(V1**2 + 6*phi2**2*V1*V2 - 2*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3))) + c**6*dt**2*(-40*dx**2*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) + dt**2*(3*V1**2 + 8*phi2**2*V1*V2 - 8*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)))) + 
	2*c**4*dx**2*(4*dx**2*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)) - 5*dt**2*(V1**2 + 4*phi2**2*V1*V2 - 4*(dphi1**2*(V2 - 4*phi2**2*V3) + dphi2**2*(V2 + 2*phi2**2*V3)))))))/(360.*(-1 + c**2)**5)

	I4 = I2 + I4diff
      
	return H0, H2, H4, I0, I2, I4
      
